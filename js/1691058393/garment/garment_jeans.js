function Garment(e,t){var i=this;this.step="",this.container=$(e),this._relations_active={},this.buttons_holes_opened=!1,this.extra_fabrics_active=!1,this.extra_linings_active=!1,this.current_extra_option=!1,this.render=$("#available_window canvas"),this.render_zoom=$("#available_window_zoom .layers"),this.loaded_images=[],this.pocket_square=$(".pocket_square",this.container),this.render_enabled=!0,this.current_fabric_activator_parent="",this.id_box_opt_fabric="",this.bLazy_fabric=!1,this.bLazy_extra=!1,this.fabric_preview_open=!1,this.image_size="STD",this.multi_fabric=!1,this.multi_fabric_active=!1,this.multi_fabric_options=[],this.position_render="",this.zoom="",this.last_change="",this.has_extra_lining=!1,this.has_extra_unlined=!1,this.manualStateChange=!0,this.previous_view="side",this.quilted_alert=!1,this.unlined_coat_alert=!1,this.winter_lining_alert=!1,this.views=[],this.pre_filter_active=!1,this.shirt_style_click=!1,this.customer_active=!1,this.lastSharedUrl=null,this._events={},this.logos_code={},this.current_coat_mode=!1,this.filters_applied=[],this.pinchZoom=[],this.zoom_mode_active=!1,this.current_CanvasId=!1,this.status_step=0,this.modeNext=!1,this.session_time=Date.now(),this.inactive_time=0,this.limit_session_time=0,this.limit_inactive_time=0,this.popup_status_step=0,this.bf_dsc=0,this.info_fit_popup=!1,this.extraColorModified=[],this.vertical_mode=!1,this.finishing_previous=!1,this.fit_previous=!1,this.new_images=[],this.focusArray={base:{top:{x:0,y:0,width:800},top_right:{x:0,y:0,width:800},bottom:{x:0,y:1714,width:1050},initials_front:{x:0,y:0,width:800},initials_back:{x:0,y:0,width:800}},vertical:{top:{x:0,y:0,width:800},top_right:{x:1.5,y:0,width:500},bottom:{x:0,y:1714,width:850},initials_front:{x:0,y:0,width:800},initials_back:{x:0,y:0,width:800}}},this.focusActual="general",this.parts_widths=!1,this.available_widths=!1,this.titles_widths=!1,$(document).bind("click",function(e){i.inactive_time=0});for(var r in t)this[r]=t[r];this.index_v=0,this.available_views=this.views,this.current.product_type=this.product_type,this.zoom="normal",this.current.view="front",$("#available_window").addClass(this.current.view),this.current.view_detail="inside",this.current.neck_open=0,this.current.inner_sleeve=0,this.current._show_lining=!1,this.real_product_type=this.product_type,this.current_temp={config:[],extras:[]},this.old_temp={config:[],extras:[]},$(".action_column div.price").before('<div class="price original_price"></div>'),window.blackfriday_enabled&&($(".price_bf").addClass("visible_bf"),$(".not_price_bf").hide());window.location.search.substring(1);var a={};for(var o in this.config)a[o]=this.config[o];for(var o in this.extra)a[o]=this.extra[o];this.product_config=a,this.current.model=model,this.current.style=p_style,$("#tv3 .logo").addClass("open_menu")}function parse_query_string(e,t){if(t){t=t.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var i=new RegExp("[\\?&]"+t+"=([^&#]*)").exec(e);return null==i?"":decodeURIComponent(i[1].replace(/\+/g," "))}var r,a=/\+/g,o=/([^&=]+)=?([^&]*)/g,n=function(e){return decodeURIComponent(e.replace(a," "))},s=e.replace(/^\?/,"");for(urlParams={};r=o.exec(s);)urlParams[n(r[1])]=n(r[2]);return urlParams}function formatMoney(e,t,i,r){e=e||0,t=isNaN(t=Math.abs(t))?2:t,i=i||",",r=r||".";var a=e<0?"-":"",o=parseInt(e=Math.abs(+e||0).toFixed(t),10)+"",n=(n=o.length)>3?n%3:0,s=Math.abs(e-o).toFixed(t).slice(2);return"00"==s?a+(n?o.substr(0,n)+i:"")+o.substr(n).replace(/(\d{3})(?=\d)/g,"$1"+i):a+(n?o.substr(0,n)+i:"")+o.substr(n).replace(/(\d{3})(?=\d)/g,"$1"+i)+(t?r+s:"")}function format_price(e,t,i){switch(i||(i=window.currency),t){case"small_symbol":switch(i.iso){case"GBP":return"<small>"+i.symbol+"</small>"+formatMoney(e);case"USD":r="<small>"+i.symbol+"</small>"+formatMoney(e);return"/en-ca/"!=window.region_url&&"/fr-ca/"!=window.region_url||(r+='<small style="font-size: 50%">USD</small>'),r;case"AUD":return"<small>AU"+i.symbol+"</small>"+formatMoney(e);case"MXN":return"<small>MX"+i.symbol+"</small>"+formatMoney(e);case"RUB":return formatMoney(e)+"<small>p</small>";case"CHF":return"<small>CHF </small>"+formatMoney(e,2,"'",".");default:return formatMoney(e,2,".",",")+"<small>"+i.symbol+"</small>"}case"text":default:switch(i.iso){case"GBP":return i.symbol+formatMoney(e);case"USD":var r=i.symbol+formatMoney(e);return"/en-ca/"!=window.region_url&&"/fr-ca/"!=window.region_url||(r+='<small style="font-size: 50%">USD</small>'),r;case"AUD":return"AU"+i.symbol+formatMoney(e);case"MXN":return"MX"+i.symbol+formatMoney(e);case"RUB":return formatMoney(e)+"p";case"CHF":return"<small>CHF </small>"+formatMoney(e,2,"'",".");default:return formatMoney(e)+i.symbol}}}function str_replace(e,t,i,r){var a=0,o=0,n="",s="",c=0,l=0,d=[].concat(e),p=[].concat(t),u=i,f="[object Array]"===Object.prototype.toString.call(p),_="[object Array]"===Object.prototype.toString.call(u);for(u=[].concat(u),r&&(this.window[r]=0),a=0,c=u.length;a<c;a++)if(""!==u[a])for(o=0,l=d.length;o<l;o++)n=u[a]+"",s=f?void 0!==p[o]?p[o]:"":p[0],u[a]=n.split(d[o]).join(s),r&&u[a]!==n&&(this.window[r]+=(n.length-u[a].length)/d[o].length);return _?u:u[0]}function strpos(e,t,i){var r=(e+"").indexOf(t,i||0);return-1!==r&&r}function array_push(e){var t=0,i="",r=arguments,a=r.length,o=/^\d$/,n=0,s=0,c=0;if(e.hasOwnProperty("length")){for(t=1;t<a;t++)e[e.length]=r[t];return e.length}for(i in e)e.hasOwnProperty(i)&&(++c,-1!==i.search(o)&&(s=(n=parseInt(i,10))>s?n:s));for(t=1;t<a;t++)e[++s]=r[t];return c+t-1}function empty(e){var t,i,r,a=[void 0,null,!1,0,"","0"];for(i=0,r=a.length;i<r;i++)if(e===a[i])return!0;if("object"==typeof e){for(t in e)return!1;return!0}return!1}function array_merge(){var e,t=Array.prototype.slice.call(arguments),i=t.length,r={},a="",o=0,n=0,s=0,c=0,l=Object.prototype.toString,d=!0;for(s=0;s<i;s++)if("[object Array]"!==l.call(t[s])){d=!1;break}if(d){for(d=[],s=0;s<i;s++)d=d.concat(t[s]);return d}for(s=0,c=0;s<i;s++)if(e=t[s],"[object Array]"===l.call(e))for(n=0,o=e.length;n<o;n++)r[c++]=e[n];else for(a in e)e.hasOwnProperty(a)&&(parseInt(a,10)+""===a?r[c++]=e[a]:r[a]=e[a]);return r}!function(e,t){"function"==typeof define&&define.amd?define(t):"object"==typeof exports?module.exports=t():e.Blazy=t()}(this,function(){"use strict";function e(e){var i=e._util;i.elements=_(e.options),i.count=i.elements.length,i.destroyed&&(i.destroyed=!1,e.options.container&&g(e.options.container,function(e){h(e,"scroll",i.validateT)}),h(window,"resize",i.saveViewportOffsetT),h(window,"resize",i.validateT),h(window,"scroll",i.validateT)),t(e)}function t(e){for(var t=e._util,r=0;r<t.count;r++){var a=t.elements[r];(i(a,e.options)||u(a,e.options.successClass))&&(e.load(a),t.elements.splice(r,1),t.count--,r--)}0===t.count&&e.destroy()}function i(e,t){var i=e.getBoundingClientRect();if(t.container&&C){var a=e.closest(t.containerClass);if(a){var o=a.getBoundingClientRect();if(r(o,w)){var n=o.top-t.offset,s=o.right+t.offset,c=o.bottom+t.offset,l=o.left-t.offset;return r(i,{top:n>w.top?n:w.top,right:s<w.right?s:w.right,bottom:c<w.bottom?c:w.bottom,left:l>w.left?l:w.left})}return!1}}return r(i,w)}function r(e,t){return e.right>=t.left&&e.bottom>=t.top&&e.left<=t.right&&e.top<=t.bottom}function a(e,t,i){if(!u(e,i.successClass)&&(t||i.loadInvisible||e.offsetWidth>0&&e.offsetHeight>0)){var r=l(e,$)||l(e,i.src);if(r){var a=r.split(i.separator),c=a[y&&a.length>1?1:0],d=l(e,i.srcset),_=p(e,"img"),v=e.parentNode,b=v&&p(v,"picture");if(_||void 0===e.src){var w=new Image,C=function(){i.error&&i.error(e,"invalid"),f(e,i.errorClass),m(w,"error",C),m(w,"load",S)},S=function(){_?b||s(e,c,d):e.style.backgroundImage='url("'+c+'")',o(e,i),m(w,"load",S),m(w,"error",C)};b&&(w=e,g(v.getElementsByTagName("source"),function(e){n(e,k,i.srcset)})),h(w,"error",C),h(w,"load",S),s(w,c,d)}else e.src=c,o(e,i)}else p(e,"video")?(g(e.getElementsByTagName("source"),function(e){n(e,x,i.src)}),e.load(),o(e,i)):(i.error&&i.error(e,"missing"),f(e,i.errorClass))}}function o(e,t){f(e,t.successClass),t.success&&t.success(e),d(e,t.src),d(e,t.srcset),g(t.breakpoints,function(t){d(e,t.src)})}function n(e,t,i){var r=l(e,i);r&&(c(e,t,r),d(e,i))}function s(e,t,i){i&&c(e,k,i),e.src=t}function c(e,t,i){e.setAttribute(t,i)}function l(e,t){return e.getAttribute(t)}function d(e,t){e.removeAttribute(t)}function p(e,t){return e.nodeName.toLowerCase()===t}function u(e,t){return-1!==(" "+e.className+" ").indexOf(" "+t+" ")}function f(e,t){u(e,t)||(e.className+=" "+t)}function _(e){for(var t=[],i=e.root.querySelectorAll(e.selector),r=i.length;r--;t.unshift(i[r]));return t}function v(e){w.bottom=(window.innerHeight||document.documentElement.clientHeight)+e,w.right=(window.innerWidth||document.documentElement.clientWidth)+e}function h(e,t,i){e.attachEvent?e.attachEvent&&e.attachEvent("on"+t,i):e.addEventListener(t,i,{capture:!1,passive:!0})}function m(e,t,i){e.detachEvent?e.detachEvent&&e.detachEvent("on"+t,i):e.removeEventListener(t,i,{capture:!1,passive:!0})}function g(e,t){if(e&&t)for(var i=e.length,r=0;r<i&&!1!==t(e[r],r);r++);}function b(e,t,i){var r=0;return function(){var a=+new Date;a-r<t||(r=a,e.apply(i,arguments))}}var $,w,y,C,x="src",k="srcset";return function(i){if(!document.querySelectorAll){var r=document.createStyleSheet();document.querySelectorAll=function(e,t,i,a,o){for(o=document.all,t=[],i=(e=e.replace(/\[for\b/gi,"[htmlFor").split(",")).length;i--;){for(r.addRule(e[i],"k:v"),a=o.length;a--;)o[a].currentStyle.k&&t.push(o[a]);r.removeRule(0)}return t}}var o=this,n=o._util={};n.elements=[],n.destroyed=!0,o.options=i||{},o.options.error=o.options.error||!1,o.options.offset=o.options.offset||100,o.options.root=o.options.root||document,o.options.success=o.options.success||!1,o.options.selector=o.options.selector||".b-lazy",o.options.separator=o.options.separator||"|",o.options.containerClass=o.options.container,o.options.container=!!o.options.containerClass&&document.querySelectorAll(o.options.containerClass),o.options.errorClass=o.options.errorClass||"b-error",o.options.breakpoints=o.options.breakpoints||!1,o.options.loadInvisible=o.options.loadInvisible||!1,o.options.successClass=o.options.successClass||"b-loaded",o.options.validateDelay=o.options.validateDelay||25,o.options.saveViewportOffsetDelay=o.options.saveViewportOffsetDelay||50,o.options.srcset=o.options.srcset||"data-srcset",o.options.src=$=o.options.src||"data-src",C=Element.prototype.closest,y=window.devicePixelRatio>1,(w={}).top=0-o.options.offset,w.left=0-o.options.offset,o.revalidate=function(){e(o)},o.load=function(e,t){var i=this.options;e&&void 0===e.length?a(e,t,i):g(e,function(e){a(e,t,i)})},o.destroy=function(){var e=o._util;o.options.container&&g(o.options.container,function(t){m(t,"scroll",e.validateT)}),m(window,"scroll",e.validateT),m(window,"resize",e.validateT),m(window,"resize",e.saveViewportOffsetT),e.count=0,e.elements.length=0,e.destroyed=!0},n.validateT=b(function(){t(o)},o.options.validateDelay,o),n.saveViewportOffsetT=b(function(){v(o.options.offset)},o.options.saveViewportOffsetDelay,o),v(o.options.offset),g(o.options.breakpoints,function(e){if(e.width>=window.screen.width)return $=e.src,!1}),setTimeout(function(){e(o)})}}),Garment.prototype.initShareProduct=function(){function e(){var e=$("#share_popup2");$(".share_link",e).removeClass("copied");var r=$(".background_blur");if(e.hasClass("show"))return e.removeClass("show"),void r.removeClass("show");if(null!=o.lastSharedUrl)return e.addClass("show"),void r.addClass("show");e.addClass("show"),r.addClass("show"),$(".actions",e).addClass("hide"),$(".loading",e).addClass("visible"),o.cleanInputAutoDelete(),$(o.container).append('<input type="hidden" name="next_share_product" value="1" class="input_auto_delete"/>');var a=$("form").serialize(),n=window.location.origin+"/"+region+"/services/personalize/"+o.product_type+"?ajax=1";t(),$.ajax({type:"POST",url:n,data:a,success:function(t){if(t){if("error"==t)return void e.removeClass("show");var r=(t=JSON.parse(t)).url_product;o.lastSharedUrl=t.url_product,$(".share_link",e).attr("href",r);var a=t.product_title;$(".product_title",e).html(a),$(".native",e).attr("data-link",r),$(".native",e).attr("data-title",a),i(t.id_product),dataLayer.push({event:"share_product",eventCategory:"share_product",eventAction:"share",eventLabel:"desktop"})}}})}function t(){var e=document.getElementById("available_window"),t=$(".viewport",e).get(0);"man_chino"!=o.product_type&&"man_jeans"!=o.product_type&&"man_shoe"!=o.product_type||(t=$("#canvas_render",e).get(0));var i=t.offsetTop,n=0,s=0,c=[];$("#available_window .viewport img").each(function(){var e={obj:this,zindex:parseInt(this.style.zIndex),top:this.offsetTop+i,height:this.height,width:this.width};c.push(e),e.height>n&&(n=e.height),e.width>s&&(s=e.width)}),c.sort(function(e,t){return e.zindex-t.zindex});var l={obj:document.getElementsByClassName("logo_to_canvas")[0].getElementsByTagName("img")[0],zindex:0,top:735,left:600,height:38,width:160,logo:!0};"man_shoe"==o.product_type||"man_jeans"==o.product_type||"man_chino"==o.product_type?r(c,s,n,l):(c.push(l),a(c,s,n))}function i(e){var t=window.location.origin+"/"+region+"/services/personalize/save_share_image?id_product="+e+"ajax=1",i={data:document.getElementById("share_product_canvas").toDataURL("image/jpeg")};$.ajax({type:"POST",url:t,data:i,success:function(e){"ko"!=e&&($(".native",l).attr("data-file",e),$(".actions",l).removeClass("hide"),$(".loading",l).removeClass("visible"))}})}function r(e,t,i,r){var a=document.getElementById("share_product_canvas");a.width=800,a.height=800;var n=a.height,s=a.height;Math.min(n/i,s/t);void 0===o.pinchZoom.share_product_canvas&&o.initCanvas("share_product_canvas",!1);var c=a.getContext("2d");if(c.fillStyle="#EFEFEF",c.fillRect(0,0,n,s),o.pinchZoom.share_product_canvas.setNotClearCanvas(),o.pinchZoom.share_product_canvas.setImages(o.new_images,o.current.view),r){var l=new Image;l.src=r.obj.src,l.crossOrigin="anonymous",l.onload=function(){c.drawImage(l,r.left*a.width/800,r.top*a.width/800,r.width*a.width/800,r.height*a.width/800);var e=$(".designed_by_me").html();c.fillStyle="#9a9b9a",c.font="lighter 40px gt-haptik",c.save(),"man_jeans"==o.product_type||"man_chino"==o.product_type?(c.textAlign="right",c.rotate(-90*Math.PI/180),c.fillText(e,-30,50)):c.fillText(e,20,50),c.restore()}}}function a(e,t,i){var r=!1;if("man_smoking"!=o.product_type&&"man_frac"!=o.product_type&&"man_levita"!=o.product_type&&"man_chaque"!=o.product_type||(r=!0),"man_shoe"==o.product_type||"man_jeans"==o.product_type||"man_chino"==o.product_type)a=o.render_info.viewport[o.current.view].base;else if(void 0===o.viewport[o.current.view][o.product_type]||r&&"without_model"!=o.current.view)a=o.viewport[o.current.view].base;else var a=o.viewport[o.current.view][o.product_type];void 0===a.top&&(a.top=0),void 0===a.ratio&&(a.ratio=a.h/a.w);var n=1;"without_model"==o.current.view&&("man_suit2"==o.product_type||"man_suit3"==o.product_type||"man_smoking"==o.product_type)&&$(window).width()>900&&(n=1.12),"without_model"==o.current.view&&("man_suit2"==o.product_type||"man_suit3"==o.product_type||"man_smoking"==o.product_type)&&$(window).width()<=900&&(n=1.08),"folded"==o.current.view&&"man_shirt"==o.product_type&&(n=1),"without_model"==o.current.view&&"man_jacket"==o.product_type&&(n=1.08),i=t*a.ratio;var s=document.getElementById("share_product_canvas");s.width=800,s.height=800;var c={man_shirt:.4,man_pants:0},l=0;void 0!==c[o.product_type]&&(l=c[o.product_type]);var d=a.top*l,p=s.height*n,u=s.height,f=Math.min(p/i,u/t),_=s.getContext("2d");_.fillStyle="#efefef",_.fillRect(0,0,p,u);for(var v=(u-e[0].width*f)/2,h=0;h<e.length;h++)e[h].logo?_.drawImage(e[h].obj,e[h].left,e[h].top,e[h].width,e[h].height):("man_jacket"==o.product_type&&"without_model"==o.current.view&&(e[h].top=0),"man_waistcoat"==o.product_type&&"without_model"==o.current.view&&(e[h].top=0),"man_waistcoat"==o.product_type&&o.current.view,_.drawImage(e[h].obj,v,(e[h].top-d)*f,e[h].width*f,e[h].height*f));var m=$(".designed_by_me").html();_.fillStyle="#9a9b9a",_.font="lighter 42px gt-haptik",_.textAlign="center",_.save(),_.translate(70,230),_.rotate(-90*Math.PI/180),_.fillText(m,0,0),_.restore()}var o=this,n=$("body"),s=document.getElementById("share_product2"),c=document.createElement("div");c.innerHTML=s.innerText,s.parentNode.replaceChild(c,s);l=$("#share_popup2");n.on("click",".shareButton",function(){e()}),n.on("click",".background_blur",function(){e()});var l=$("#share_popup2"),d=$(".background_blur");l.on("click",".close",function(){l.removeClass("show"),d.removeClass("show")});var p=!1;$("#share_popup2").on("touchstart",function(e){p=e.originalEvent.changedTouches[0].clientY}),$("#share_popup2").on("touchend",function(t){isTouched=!1,Math.round(t.originalEvent.changedTouches[0].clientY-p)>=0&&(p=0,e())}),$(".shareButton").addClass("active"),$(".share_ios").removeClass("active"),(["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document)&&($(".shareButton:not(.share_ios)").hide(),$(".shareButton").removeClass("active"),$(".share_ios").addClass("active")),$(".share_image, #share_product_canvas",l).click(function(){var e=new Date,t=e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDate()+" "+e.getHours()+":"+e.getMinutes()+":"+e.getSeconds(),i=document.title+" "+t+".png".toLowerCase();document.getElementById("share_product_canvas").toBlob(function(e){const t=document.createElement("a");t.download=i,t.href=URL.createObjectURL(e),t.click(),URL.revokeObjectURL(t.href)},"image/png",1)}),$(".share_link",l).click(function(){var e=$("<input>"),t=$(this).attr("href");$("body").append(e),$(this).addClass("copied"),e.val(t).select(),document.execCommand("copy"),e.remove()}),l.on("click","a.native",function(e){e.preventDefault();var t=$(this);return fetch(t.data("file")).then(function(e){return e.blob()}).then(function(e){var i=[new File([e],t.data("title")+".jpg",{type:"image/jpeg"})];navigator.canShare&&navigator.canShare({files:i})&&navigator.share({text:t.data("text")+" "+t.data("link"),files:i,title:t.data("title")}).then(function(){dataLayer.push({event:"share_product",eventCategory:"share_product",eventAction:"native",eventLabel:"mobile"})}).catch(function(e){})}),!1})},function(e){"function"==typeof define&&define.amd&&define.amd.jQuery?define(["jquery"],e):e(jQuery)}(function(e){function t(t){return!t||void 0!==t.allowPageScroll||void 0===t.swipe&&void 0===t.swipeStatus||(t.allowPageScroll=l),void 0!==t.click&&void 0===t.tap&&(t.tap=t.click),t||(t={}),t=e.extend({},e.fn.swipe.defaults,t),this.each(function(){var r=e(this),a=r.data(T);a||(a=new i(this,t),r.data(T,a))})}function i(t,i){function z(t){if(!(le()||e(t.target).closest(i.excludedElements,qe).length>0)){var r,a=t.originalEvent?t.originalEvent:t,o=a.touches,n=o?o[0]:a;return He=$,o?Ze=o.length:t.preventDefault(),Fe=0,je=null,Ue=null,Re=0,Me=0,Ge=0,De=1,Ne=0,Ve=_e(),Be=me(),se(),!o||Ze===i.fingers||i.fingers===g||B()?(pe(0,n),Xe=Se(),2==Ze&&(pe(1,o[1]),Me=Ge=$e(Ve[0].start,Ve[1].start)),(i.swipeStatus||i.pinchStatus)&&(r=F(a,He))):r=!1,!1===r?(He=C,F(a,He),r):(i.hold&&(et=setTimeout(e.proxy(function(){qe.trigger("hold",[a.target]),i.hold&&(r=i.hold.call(qe,a,a.target))},this),i.longTapThreshold)),de(!0),null)}}function E(e){var t=e.originalEvent?e.originalEvent:e;if(He!==y&&He!==C&&!ce()){var r,a=t.touches,o=ue(a?a[0]:t);if(We=Se(),a&&(Ze=a.length),i.hold&&clearTimeout(et),He=w,2==Ze&&(0==Me?(pe(1,a[1]),Me=Ge=$e(Ve[0].start,Ve[1].start)):(ue(a[1]),Ge=$e(Ve[0].end,Ve[1].end),Ue=ye(Ve[0].end,Ve[1].end)),De=we(Me,Ge),Ne=Math.abs(Me-Ge)),Ze===i.fingers||i.fingers===g||!a||B()){if(je=ke(o.start,o.end),N(e,je),Fe=Ce(o.start,o.end),Re=be(),ve(je,Fe),(i.swipeStatus||i.pinchStatus)&&(r=F(t,He)),!i.triggerOnTouchEnd||i.triggerOnTouchLeave){var n=!0;if(i.triggerOnTouchLeave){var s=Te(this);n=ze(o.end,s)}!i.triggerOnTouchEnd&&n?He=A(w):i.triggerOnTouchLeave&&!n&&(He=A(y)),He!=C&&He!=y||F(t,He)}}else F(t,He=C);!1===r&&F(t,He=C)}}function P(e){var t=e.originalEvent?e.originalEvent:e,r=t.touches;return r&&r.length?(ne(),!0):(ce()&&(Ze=Qe),We=Se(),Re=be(),M()||!R()?F(t,He=C):i.triggerOnTouchEnd||0==i.triggerOnTouchEnd&&He===w?(e.preventDefault(),F(t,He=y)):!i.triggerOnTouchEnd&&J()?j(t,He=y,f):He===w&&F(t,He=C),de(!1),null)}function I(){Ze=0,We=0,Xe=0,Me=0,Ge=0,De=1,se(),de(!1)}function L(e){var t=e.originalEvent?e.originalEvent:e;i.triggerOnTouchLeave&&F(t,He=A(y))}function O(){qe.unbind(Pe,z),qe.unbind(Ae,I),qe.unbind(Ie,E),qe.unbind(Le,P),Oe&&qe.unbind(Oe,L),de(!1)}function A(e){var t=e,r=D(),a=R(),o=M();return!r||o?t=C:!a||e!=w||i.triggerOnTouchEnd&&!i.triggerOnTouchLeave?!a&&e==y&&i.triggerOnTouchLeave&&(t=C):t=y,t}function F(e,t){var i,r=e.touches;return V()||Z()||q()||B()?((V()||Z())&&(i=j(e,t,p)),(q()||B())&&!1!==i&&(i=j(e,t,u))):ae()&&!1!==i?i=j(e,t,_):oe()&&!1!==i?i=j(e,t,v):re()&&!1!==i&&(i=j(e,t,f)),t===C&&I(e),t===y&&(r?r.length||I(e):I(e)),i}function j(t,l,d){var h;if(d==p){if(qe.trigger("swipeStatus",[l,je||null,Fe||0,Re||0,Ze,Ve]),i.swipeStatus&&!1===(h=i.swipeStatus.call(qe,t,l,je||null,Fe||0,Re||0,Ze,Ve)))return!1;if(l==y&&H()){if(qe.trigger("swipe",[je,Fe,Re,Ze,Ve]),i.swipe&&!1===(h=i.swipe.call(qe,t,je,Fe,Re,Ze,Ve)))return!1;switch(je){case r:qe.trigger("swipeLeft",[je,Fe,Re,Ze,Ve]),i.swipeLeft&&(h=i.swipeLeft.call(qe,t,je,Fe,Re,Ze,Ve));break;case a:qe.trigger("swipeRight",[je,Fe,Re,Ze,Ve]),i.swipeRight&&(h=i.swipeRight.call(qe,t,je,Fe,Re,Ze,Ve));break;case o:qe.trigger("swipeUp",[je,Fe,Re,Ze,Ve]),i.swipeUp&&(h=i.swipeUp.call(qe,t,je,Fe,Re,Ze,Ve));break;case n:qe.trigger("swipeDown",[je,Fe,Re,Ze,Ve]),i.swipeDown&&(h=i.swipeDown.call(qe,t,je,Fe,Re,Ze,Ve))}}}if(d==u){if(qe.trigger("pinchStatus",[l,Ue||null,Ne||0,Re||0,Ze,De,Ve]),i.pinchStatus&&!1===(h=i.pinchStatus.call(qe,t,l,Ue||null,Ne||0,Re||0,Ze,De,Ve)))return!1;if(l==y&&U())switch(Ue){case s:qe.trigger("pinchIn",[Ue||null,Ne||0,Re||0,Ze,De,Ve]),i.pinchIn&&(h=i.pinchIn.call(qe,t,Ue||null,Ne||0,Re||0,Ze,De,Ve));break;case c:qe.trigger("pinchOut",[Ue||null,Ne||0,Re||0,Ze,De,Ve]),i.pinchOut&&(h=i.pinchOut.call(qe,t,Ue||null,Ne||0,Re||0,Ze,De,Ve))}}return d==f?l!==C&&l!==y||(clearTimeout(Ke),clearTimeout(et),Q()&&!ee()?(Ye=Se(),Ke=setTimeout(e.proxy(function(){Ye=null,qe.trigger("tap",[t.target]),i.tap&&(h=i.tap.call(qe,t,t.target))},this),i.doubleTapThreshold)):(Ye=null,qe.trigger("tap",[t.target]),i.tap&&(h=i.tap.call(qe,t,t.target)))):d==_?l!==C&&l!==y||(clearTimeout(Ke),Ye=null,qe.trigger("doubletap",[t.target]),i.doubleTap&&(h=i.doubleTap.call(qe,t,t.target))):d==v&&(l!==C&&l!==y||(clearTimeout(Ke),Ye=null,qe.trigger("longtap",[t.target]),i.longTap&&(h=i.longTap.call(qe,t,t.target)))),h}function R(){var e=!0;return null!==i.threshold&&(e=Fe>=i.threshold),e}function M(){var e=!1;return null!==i.cancelThreshold&&null!==je&&(e=he(je)-Fe>=i.cancelThreshold),e}function G(){return null===i.pinchThreshold||Ne>=i.pinchThreshold}function D(){return!i.maxTimeThreshold||!(Re>=i.maxTimeThreshold)}function N(e,t){if(!1!==i.preventDefaultEvents)if(i.allowPageScroll===l)e.preventDefault();else{var s=i.allowPageScroll===d;switch(t){case r:(i.swipeLeft&&s||!s&&i.allowPageScroll!=h)&&e.preventDefault();break;case a:(i.swipeRight&&s||!s&&i.allowPageScroll!=h)&&e.preventDefault();break;case o:(i.swipeUp&&s||!s&&i.allowPageScroll!=m)&&e.preventDefault();break;case n:(i.swipeDown&&s||!s&&i.allowPageScroll!=m)&&e.preventDefault()}}}function U(){var e=X(),t=W(),i=G();return e&&t&&i}function B(){return!!(i.pinchStatus||i.pinchIn||i.pinchOut)}function q(){return!(!U()||!B())}function H(){var e=D(),t=R(),i=X(),r=W();return!M()&&r&&i&&t&&e}function Z(){return!!(i.swipe||i.swipeStatus||i.swipeLeft||i.swipeRight||i.swipeUp||i.swipeDown)}function V(){return!(!H()||!Z())}function X(){return Ze===i.fingers||i.fingers===g||!x}function W(){return 0!==Ve[0].end.x}function J(){return!!i.tap}function Q(){return!!i.doubleTap}function Y(){return!!i.longTap}function K(){if(null==Ye)return!1;var e=Se();return Q()&&e-Ye<=i.doubleTapThreshold}function ee(){return K()}function te(){return(1===Ze||!x)&&(isNaN(Fe)||Fe<i.threshold)}function ie(){return Re>i.longTapThreshold&&Fe<b}function re(){return!(!te()||!J())}function ae(){return!(!K()||!Q())}function oe(){return!(!ie()||!Y())}function ne(){Je=Se(),Qe=event.touches.length+1}function se(){Je=0,Qe=0}function ce(){var e=!1;return Je&&Se()-Je<=i.fingerReleaseThreshold&&(e=!0),e}function le(){return!(!0!==qe.data(T+"_intouch"))}function de(e){!0===e?(qe.bind(Ie,E),qe.bind(Le,P),Oe&&qe.bind(Oe,L)):(qe.unbind(Ie,E,!1),qe.unbind(Le,P,!1),Oe&&qe.unbind(Oe,L,!1)),qe.data(T+"_intouch",!0===e)}function pe(e,t){var i=void 0!==t.identifier?t.identifier:0;return Ve[e].identifier=i,Ve[e].start.x=Ve[e].end.x=t.pageX||t.clientX,Ve[e].start.y=Ve[e].end.y=t.pageY||t.clientY,Ve[e]}function ue(e){var t=fe(void 0!==e.identifier?e.identifier:0);return t.end.x=e.pageX||e.clientX,t.end.y=e.pageY||e.clientY,t}function fe(e){for(var t=0;t<Ve.length;t++)if(Ve[t].identifier==e)return Ve[t]}function _e(){for(var e=[],t=0;t<=5;t++)e.push({start:{x:0,y:0},end:{x:0,y:0},identifier:0});return e}function ve(e,t){t=Math.max(t,he(e)),Be[e].distance=t}function he(e){if(Be[e])return Be[e].distance}function me(){var e={};return e[r]=ge(r),e[a]=ge(a),e[o]=ge(o),e[n]=ge(n),e}function ge(e){return{direction:e,distance:0}}function be(){return We-Xe}function $e(e,t){var i=Math.abs(e.x-t.x),r=Math.abs(e.y-t.y);return Math.round(Math.sqrt(i*i+r*r))}function we(e,t){return(t/e*1).toFixed(2)}function ye(){return De<1?c:s}function Ce(e,t){return Math.round(Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)))}function xe(e,t){var i=e.x-t.x,r=t.y-e.y,a=Math.atan2(r,i),o=Math.round(180*a/Math.PI);return o<0&&(o=360-Math.abs(o)),o}function ke(e,t){var i=xe(e,t);return i<=45&&i>=0?r:i<=360&&i>=315?r:i>=135&&i<=225?a:i>45&&i<135?n:o}function Se(){return(new Date).getTime()}function Te(t){var i=(t=e(t)).offset();return{left:i.left,right:i.left+t.outerWidth(),top:i.top,bottom:i.top+t.outerHeight()}}function ze(e,t){return e.x>t.left&&e.x<t.right&&e.y>t.top&&e.y<t.bottom}var Ee=x||S||!i.fallbackToMouseEvents,Pe=Ee?S?k?"MSPointerDown":"pointerdown":"touchstart":"mousedown",Ie=Ee?S?k?"MSPointerMove":"pointermove":"touchmove":"mousemove",Le=Ee?S?k?"MSPointerUp":"pointerup":"touchend":"mouseup",Oe=Ee?null:"mouseleave",Ae=S?k?"MSPointerCancel":"pointercancel":"touchcancel",Fe=0,je=null,Re=0,Me=0,Ge=0,De=1,Ne=0,Ue=0,Be=null,qe=e(t),He="start",Ze=0,Ve=null,Xe=0,We=0,Je=0,Qe=0,Ye=0,Ke=null,et=null;try{qe.bind(Pe,z),qe.bind(Ae,I)}catch(t){e.error("events not supported "+Pe+","+Ae+" on jQuery.swipe")}this.enable=function(){return qe.bind(Pe,z),qe.bind(Ae,I),qe},this.disable=function(){return O(),qe},this.destroy=function(){O(),qe.data(T,null),qe=null},this.option=function(t,r){if(void 0!==i[t]){if(void 0===r)return i[t];i[t]=r}else e.error("Option "+t+" does not exist on jQuery.swipe.options");return null}}var r="left",a="right",o="up",n="down",s="in",c="out",l="none",d="auto",p="swipe",u="pinch",f="tap",_="doubletap",v="longtap",h="horizontal",m="vertical",g="all",b=10,$="start",w="move",y="end",C="cancel",x="ontouchstart"in window,k=window.navigator.msPointerEnabled&&!window.navigator.pointerEnabled,S=window.navigator.pointerEnabled||window.navigator.msPointerEnabled,T="TouchSwipe",z={fingers:1,threshold:75,cancelThreshold:null,pinchThreshold:20,maxTimeThreshold:null,fingerReleaseThreshold:250,longTapThreshold:500,doubleTapThreshold:200,swipe:null,swipeLeft:null,swipeRight:null,swipeUp:null,swipeDown:null,swipeStatus:null,pinchIn:null,pinchOut:null,pinchStatus:null,click:null,tap:null,doubleTap:null,longTap:null,hold:null,triggerOnTouchEnd:!0,triggerOnTouchLeave:!1,allowPageScroll:"auto",fallbackToMouseEvents:!0,excludedElements:"label, button, input, select, textarea, a, .noSwipe",preventDefaultEvents:!0};e.fn.swipe=function(i){var r=e(this),a=r.data(T);if(a&&"string"==typeof i){if(a[i])return a[i].apply(this,Array.prototype.slice.call(arguments,1));e.error("Method "+i+" does not exist on jQuery.swipe")}else if(!(a||"object"!=typeof i&&i))return t.apply(this,arguments);return r},e.fn.swipe.version="1.6.9",e.fn.swipe.defaults=z,e.fn.swipe.phases={PHASE_START:$,PHASE_MOVE:w,PHASE_END:y,PHASE_CANCEL:C},e.fn.swipe.directions={LEFT:r,RIGHT:a,UP:o,DOWN:n,IN:s,OUT:c},e.fn.swipe.pageScroll={NONE:l,HORIZONTAL:h,VERTICAL:m,AUTO:d},e.fn.swipe.fingers={ONE:1,TWO:2,THREE:3,ALL:g}}),Garment.prototype.gaEvent=function(e){var t=e;"zoom"==e&&(t="zoom_model"),this.push_dataLayer("config_"+this.product_type,"step:"+t)},Garment.prototype.stepSetURL=function(e){History.pushState({step:e},this.window_title,"?step="+e)},Garment.prototype.stepSwitch=function(e){if(this.gaEvent(e),"zoom"==e)return $(".image_render_full").addClass(this.current.view),$(".image_render_full .layers").html(""),$(".image_render_full").addClass("active"),this.zoom_mode_active=!0,this.renderDraw("BIG"),!1;this.zoom_mode_active=!1,this.handleResize(),$(".image_render_full").removeClass(this.current.view),$(".image_render_full").removeClass("active")},Garment.prototype.bind=function(e,t){void 0===this._events[e]&&(this._events[e]=[]),this._events[e].push(t)},Garment.prototype.trigger=function(e,t){if(void 0!==this._events[e])for(var i in this._events[e])this._events[e][i].apply(this,t)},Garment.prototype.unbind=function(e,t){if(void 0!==this._events[e]){var i=this._events[e].indexOf(t);i>-1&&this._events[e].splice(i,1)}},Garment.prototype.parse_query_string=function(e,t){if(t){t=t.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var i=new RegExp("[\\?&]"+t+"=([^&#]*)").exec(e);return null==i?"":decodeURIComponent(i[1].replace(/\+/g," "))}var r,a=/\+/g,o=/([^&=]+)=?([^&]*)/g,n=function(e){return decodeURIComponent(e.replace(a," "))},s=e.replace(/^\?/,"");for(urlParams={};r=o.exec(s);)urlParams[n(r[1])]=n(r[2]);return urlParams},Garment.prototype.scrolltoFabric=function(e){setTimeout(function(){var t=0,i=$(e+" .fabric_box.checked");i.length&&(t=i.offset().top-200),$(e).animate({scrollTop:t},500)},600)},Garment.prototype.cleanInputAutoDelete=function(){$(".input_auto_delete",this.container).remove()},Garment.prototype.initGarment=function(){function e(){var e=document.fullscreenElement&&null!==document.fullscreenElement||document.webkitFullscreenElement&&null!==document.webkitFullscreenElement||document.mozFullScreenElement&&null!==document.mozFullScreenElement||document.msFullscreenElement&&null!==document.msFullscreenElement,t=document.documentElement;e?($(".fullscreen").removeClass("visible"),document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.msExitFullscreen&&document.msExitFullscreen()):($(".fullscreen").addClass("visible"),t.requestFullscreen?t.requestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullScreen?t.webkitRequestFullScreen():t.msRequestFullscreen&&t.msRequestFullscreen())}this.initCommon(),this.formInit(),this.initConfigure(),this.initFabric(),this.initExtras(),this.initShareProduct(),this.updatePrice();r=this;$(window).on("chatOpen",function(){r.handleResize()}),$(window).on("chatClose",function(){r.handleResize()});var t=!1;"ff"==function(){for(var e,t=[],i=window.location.href.slice(window.location.href.indexOf("?")+1).split("&"),r=0;r<i.length;r++)e=i[r].split("="),t.push(e[0]),t[e[0]]=e[1];return t}().action&&(t=$("#fabric .fabric_list .fabric_box.active").first().find(".image:eq(0)").attr("rel")),default_alterate?(t&&(product.fabric[this.product_type]=t),this.updateConfiguratedProduct()):(t&&(this.current.fabric[this.product_type]=t),this.updateConfiguratedProduct("default"));var i=window.location.href,r=this,a=i.split("personalize")[1];if(a){var o="/"+region+"/services/personalize/loadProduct"+a;$.post(o,{product_type:r.product_type,url_original:i},function(e){e&&(product=jQuery.parseJSON(e),product.id_shopping_cart_detail&&product.id_product?id_cart_product=product.id_product:product.customer_edit&&product.id_shop_order_detail?(customer_edit=!0,id_shop_order_detail=product.id_shop_order_detail,$(r.container).append('<input type="hidden" name="customer_edit" value="1">'),$(r.container).append('<input type="hidden" name="id_shop_order_detail" value="'+id_shop_order_detail+'">')):product.id_shop_order_detail?(id_shop_order_detail=product.id_shop_order_detail,$(r.container).append('<input type="hidden" name="id_shop_order_detail" value="'+id_shop_order_detail+'">')):product.is_fed_product&&(is_feed_product=1),product.model&&(r.current.model=product.model),product.p_style&&(r.current.p_style=product.p_style),r.updateConfiguratedProduct())})}var n=parse_query_string(document.location.search,"view");n&&this.changeView(n,!1);var s=$("#fabric .fabric_list .fabric_box.active").length;$(".header_fabrics .number").html(s),$(".show_results .number").html(s),$(".item_menu_filter .item_menu").first().click(),$(".fabric_container_lazy").get(0).scrollHeight<=$(".fabric_container_lazy").get(0).offsetHeight&&$(".arrow_scroll").addClass("hide"),$("input").bind("focus",function(){$(window).scrollTop(10);$(window).scrollTop();$(window).scrollTop(0)}),$(window).resize(function(){"text"===$(document.activeElement).prop("type")||(($(window).width()<900||$(window).height()>$(window).width())&&!r.vertical_mode?(r.vertical_mode=!0,r.changeToVerticalMode()):($(window).width()>900||$(window).height()<$(window).width())&&r.vertical_mode&&(r.vertical_mode=!1,r.changeToHorizontalMode()),r.vertical_mode||tablet_enabled?$(".fullscreen").addClass("active"):$(".fullscreen").removeClass("active")),r.handleResize()}),$(window).resize(),$(".fullscreen").click(function(){e()}),$(window).width()<900||$(window).height()>$(window).width()?(r.vertical_mode=!0,r.changeToVerticalMode()):(r.vertical_mode=!1,r.changeToHorizontalMode());var c=this.parse_query_string(window.location.search);c.action&&"info_fabrics"==c.action&&($('.option[rel="fabric"]').click(),$(".fabric_global_list .i").click(),setTimeout(function(){r.bLazy_fabric&&r.bLazy_fabric.revalidate()},200))},Garment.prototype.changeToVerticalMode=function(){$(".personalize").addClass("vertical_mode");var e=$(window).width();$("#fabric .box_opt.config").width(e-20),$(".blocks").appendTo(".garment_form"),$("#finishing").appendTo("#fabric .box_opts"),$("#config .scroll").perfectScrollbar("destroy"),$("#fabric .scroll").perfectScrollbar("destroy"),$("#extras .scroll").perfectScrollbar("destroy"),$(".info_config_details").appendTo("form.garment_form"),$(".product_i .cart").addClass("mobile")},Garment.prototype.changeToHorizontalMode=function(){$(".personalize").removeClass("vertical_mode"),$("#fabric .box_opt.config").width("auto"),$(".blocks").appendTo(".menu_principal"),$("#finishing").prependTo("#fabric .box_opts"),$("#config .scroll").perfectScrollbar({suppressScrollX:!0}),$("#fabric .scroll").perfectScrollbar({suppressScrollX:!0}),$("#extras .scroll").perfectScrollbar({suppressScrollX:!0}),$(".info_config_details").appendTo(".blocks"),$(".product_i .cart").removeClass("mobile")},Garment.prototype.formInit=function(){var e=this;$(this.container).submit(function(){return e.formSubmit()})},Garment.prototype.formSubmit=function(){this.allow_redirect=!0;var e="1";return id_cart_product&&(e=id_cart_product),$(this.container).append('<input type="hidden" name="next" value="'+e+'" />'),!0},Garment.prototype.changeView=function(e,t=!0){var i=this.current.view;this.current.view=e;var r=this;r.index_v=0,"back"==e&&(r.index_v=1),$(".image_render").removeClass(i),$(".image_render").addClass(e),$(".image_render").removeClass("v_"+i),$(".image_render").addClass("v_"+e),$(".image_render .views li.active").removeClass("active"),$('.image_render .views li[rel="'+e+'"]').addClass("active"),t&&r.renderDraw("STD",i,e,t),r.renderInitials(),this.setPreviousNextImages(),$(window).resize()},Garment.prototype.initCommon=function(){function e(){n=$(".tab-wrap .active").position(),$(".border").stop().css({left:n.left,width:$(".tab-wrap .active").width()})}function t(){if(o.stop_counters_popup=!0,o.product_saved)return r(),!1;h.addClass("visible"),o.customer_saved&&$(".your_wish_list",favourite_popup).addClass("visible"),h.find(".loading").addClass("active");var e=o.current.view;o.current.view="front",o.renderDraw(!1,!1,!1,"save_popup_product"),o.current.view=e;var t=$(".content",h).width();0===t&&(t=330);var i=.9*t;$(".image img",h).remove(),$(".image",h).css("width",i),$(".image",h).css("height",200),$(".image",h).css("margin-top","20%");var a="";2==o.popup_status_step&&(a="bi"),3==o.popup_status_step&&(a="tri"),$(".meter",h).removeClass("bi").addClass(a);dataLayer.push({event:"save_design",eventCategory:"save_design",eventAction:"open_promt",eventLabel:"auto"});var n=$(".content",h).height();$(".content",h).css("min-height",n)}function i(){$(".input_auto_delete",o.container).remove()}function r(){var e=$("#save_product_popup"),t=$('.content input[name="email"]',e);if(null==t.val().match(/[\S]+[\@][\S]+[\.][\S]+/i))return $(".email_error_format").show(),!1;$(".email_error_format").hide(),h.removeClass("visible"),i(),$(o.container).append('<input type="hidden" name="next_save_cart" value="1"  class="input_auto_delete"/>');var r=$("form").serialize(),a=window.location.origin+"/"+region+"/services/personalize/"+o.product_type+"?ajax=1";$.ajax({type:"POST",url:a,data:r,success:function(e){if(e){id_cart_product=e,$(o.container).append('<input type="hidden" name="id_cart_cart_shareproduct" value="'+e+'"  class="input_auto_delete">');var i=region_url+"checkout/save_cart_mobile";$.post(i,{no_output:"1",action:"register",save_cart:"1",step:"cart",email:t.val()},function(e){"ok"==$.trim(e)&&dataLayer.push({event:"save_design",eventCategory:"save_design",eventAction:"save_email",eventLabel:"mobile"})}),o.product_saved=!0,$("#save_product_popup_message").addClass("visible"),setTimeout(function(){$("#save_product_popup_message").removeClass("visible")},3e3)}}})}function a(e){for(var t=$(".box_opt.extra .title:visible").find("span"),i=0,r=0;r<o.parts_widths.length-1;r++)e>=i&&e<i+o.available_widths[r]-o.titles_widths[r]&&t.eq(r).parents(".box_opt").hasClass("stitching")&&t.eq(r).css("paddingLeft",e-i+"px"),i+=o.parts_widths[r]}var o=this,n=($(".image_render",o.container),$(".preview_fabric",o.container),$(".tab-wrap .active").position());if(e(),$(".tab-wrap .option").on("click",function(t){t.preventDefault();var i=$(this).attr("rel");if(o.vertical_mode){$(".blocks").removeClass("config").removeClass("fabric").removeClass("extras").addClass("active");let e=i;"finish"==e&&(e="fabric"),$(".blocks").addClass(e),$(".blocks").attr("openid",e),"fabric"==i?$("#fabric").removeClass("mode_finish").addClass("mode_fabric"):"finish"==i&&$("#fabric").removeClass("mode_fabric").addClass("mode_finish"),$(".menu_principal").addClass("hide"),$(".blocks").scrollLeft(0),"fabric"==i&&setTimeout(function(){o.bLazy_fabric&&o.bLazy_fabric.revalidate()},200),o.calculateBallsAutoScroll();var r=$("#"+e).height()+5;"fabric"==i&&(r+=5),$(".blocks .close").css("bottom",r+"px"),"config"==i?$("#available_window").addClass("config"):$("#available_window").removeClass("config"),"extras"==i&&o.recalculeTitleExtraPadding(),o.handleResize()}else $(".tab-wrap .option").stop().removeClass("active"),$(this).stop().addClass("active"),e(),l=c.filter(".active"),$(".blocks").removeClass("config").removeClass("fabric").removeClass("extras"),$(".blocks").addClass(i),$(".product_i .cart").hasClass("extras")||($(".product_i .cart").removeClass("config").removeClass("fabric").removeClass("extras"),$(".product_i .cart").addClass(i)),"fabric"==i&&setTimeout(function(){o.bLazy_fabric&&o.bLazy_fabric.revalidate()},200),o.info_fit_popup&&o.desactiveInfoFitPopup(),o.desactiveInfoConfigtPopup();let a=i;"finish"==a&&(a="finishing");var n=$("#"+a);n.hasClass("lazy-loaded")||(n.find("img.lazy").each(function(){this.src=this.dataset.src}).removeClass("lazy"),n.addClass("lazy-loaded"))}),!mobile_enabled){var s=$("#config");s.hasClass("lazy-loaded")||(s.find("img.lazy").each(function(){this.src=this.dataset.src}).removeClass("lazy"),s.addClass("lazy-loaded"))}$("#fabric .scroll").scroll(function(){o.bLazy_fabric&&o.bLazy_fabric.revalidate()}),$(".blocks .close.general").click(function(){$(".blocks").removeClass("active"),$(".menu_principal").removeClass("hide"),$(".blocks").scrollLeft(0),$("#available_window").removeClass("config"),o.setFocusRender("general",!1),o.handleResize()}),$(".option_balls div").click(function(){var e=$(this).attr("width");return $(".blocks").animate({scrollLeft:e+"px"},400),!1});var c=$(".tab-wrap ul li"),l=c.filter(".active");History.Adapter.bind(window,"statechange",function(){o.inactive_time=0;var e=History.getState(),t="",i=["zoom"];-1!=jQuery.inArray(e.data.step,i)&&(t=e.data.step),o.stepSwitch(t)}),$(".cart").click(function(){o.vertical_mode?o.container.submit():$(this).hasClass("config")?$('.menu_principal .header .options .option[rel="fabric"]').click():$(this).hasClass("fabric")?$('.menu_principal .header .options .option[rel="extras"]').click():$(this).hasClass("extras")?o.container.submit():$('.menu_principal .header .options .option[rel="fabric"]').click()}),(["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document)&&$(".opt_r.fullscreen").remove();var d=this.parse_query_string(window.location.search);delete d.menu,d.step||(d.step="config"),History.replaceState(d,window.title),$(window).trigger("statechange");for(var p in extra_prices)$('#extra .box_opts .box_opt[id="'+p+'"]').attr("data-price",extra_prices[p]);var u=[];$("#config .container_options span",o.container).each(function(){var e=this.getAttribute("href");if(!e)return!0;e=e.replace(/^[^#]*#/,"");var t=$(this).attr("rel");t&&(t=t.split(","),u[e]=t)}),o.views.config=u;var f=[];$("#extra .container_options span",o.container).each(function(){var e=this.getAttribute("href");if(!e)return!0;e=e.replace(/^[^#]*#/,"");var t=$(this).attr("rel");t&&(t=t.split(","),f[e]=t)}),o.views.extra=f,$(".views").on("click","li",function(){return!1}),$(".view_arrow").click(function(){if($(this).hasClass("left")){e="canvas_render";void 0!==o.pinchZoom[e]&&o.pinchZoom[e].swipeRight()}else{var e="canvas_render";void 0!==o.pinchZoom[e]&&o.pinchZoom[e].swipeLeft()}}),$(".share_and_fav").on("click",".plus",function(){return o.stepSetURL("zoom"),!1}),$(".share_and_fav").on("click",".less",function(){return o.setFocusRender("general",!0),o.handleResize(),!1}),$(".image_render_full .close").click(function(){History.back()}),o.initThumbFabric(),$("#config .scroll,#fabric .scroll,#extras .scroll").scroll(function(){$(this).scrollTop()>100&&($(".menu_principal .header").addClass("minified"),$(".menu_principal .blocks").addClass("minified"))});var _=window.getStoredCart();if(_){var v=function(e){var t=0;for(var i in e)e.hasOwnProperty(i)&&++t;return t}(_.products);v>0?$(".cart_icon span").append(v):($(".cart_icon .circle").remove(),$(".cart_icon").addClass("no_products"))}else $(".cart_icon .circle").remove(),$(".cart_icon").addClass("no_products");$(".cart_icon").click(function(e){if($(this).hasClass("no_products"))return!1});var h=$("#save_product_popup");$("#save_product_popup .close").click(function(){h.removeClass("visible").removeClass("favorite_mode"),$("img",h).remove()}),$("#save_product_popup .no_thanks").click(function(){h.removeClass("visible").removeClass("favorite_mode"),$("img",h).remove()});var m=$("#privacy_popup.save_product");$("#save_product_popup .save").click(function(){m.hasClass("active")?m.addClass("visible"):r()}),$(".cancel",m).click(function(){m.removeClass("visible")}),$(".accept",m).click(function(){r(),m.removeClass("visible")});try{o.initShareAndFav()}catch(e){}mobile_enabled&&window.setInterval(function(){var e=Date.now()-o.session_time;e=Math.floor(e/1e3),o.limit_inactive_time=12,1==o.popup_status_step?o.limit_session_time=55:2==o.popup_status_step?o.limit_session_time=45:3==o.popup_status_step&&(o.limit_session_time=40);var i=!1;$("#favourite_product_popup").hasClass("visible")&&(i=!0),o.popup_status_step>0&&!i&&!o.product_saved&&!o.customer_active&&!o.stop_counters_popup&&e>o.limit_session_time&&o.inactive_time>o.limit_inactive_time&&t(),o.inactive_time++},1e3),$(window).on("chatOpen",function(){$(".personalize").addClass("r360"),o.handleResize()}),$(window).on("chatClose",function(){$(".personalize").removeClass("r360"),o.handleResize()}),$(".blocks").scroll(function(e){a(e.currentTarget.scrollLeft)})},Garment.prototype.calculateBallsAutoScroll=function(){var e=[];$(".block").each(function(){var t=$(this),i=$(this).attr("id");void 0===e[i]&&(e[i]=[]);var r=0,a=0;$(".option_balls div:not(.hide)",t).each(function(){var o=$(this).attr("rel");$(this).attr("width",r),e[i][o]=[],e[i][o].min=a;var n=$("#"+o,t).width();0==$("#"+o,t).length&&(n=$("."+o,t).width()),n||"fabrics"!=o||(n=$(".fabric_global_list",t).width(),n+=40),"config"==i?n+=20:"extras"==i&&"initials"!=o&&(n+=20),a=r+.8*n,r+=n,e[i][o].max=a})});var t=0;$(".blocks").scroll(function(){var i=$(".blocks").scrollLeft();$(".blocks .close").css("position","fixed"),0==$(".blocks").scrollLeft()?$(".blocks .close.general").css("position","absolute"):$(".blocks .close.general").css("position","fixed");var r=$(this).attr("openid");for(var a in e[r])if(i>=e[r][a].min&&i<e[r][a].max){t=a;var o=$("#"+r+' .ball[rel="'+t+'"]');o.hasClass("active")||($("#"+r+" .ball").removeClass("active"),o.addClass("active"))}})},Garment.prototype.setSizeinMenuText=function(e){var t=$('.menu_principal .option[rel="sizes"]').attr("size_i18n");"en-au"!=region&&"en-us"!=region&&"ru"!=region&&"es-mx"!=region&&(e=(e=e.toString()).replace(".",",")),$('.menu_principal .option[rel="sizes"] .title').html(t+" "+e),$('.menu_principal_minimal .option[rel="sizes"] .title').html(t+" "+e)},Garment.prototype.initConfigure=function(){function e(e,t,i,r){o.inactive_time=0,o.lastSharedUrl=null,"finishing"==i&&(o.finishing_previous=!1),"fit"==i&&(o.fit_previous=!1),$(".favourite").removeClass("hide"),$(".option_trigger",e).removeClass("active"),$('.option_trigger[rel="'+r+'"]',e).addClass("active"),t.val(r).change(),void 0!==o.product_config[i]&&(o.relationsApply(i,o.product_config[i][r]),o.vertical_mode&&o.calculateBallsAutoScroll());var a=$('.option_trigger[rel="'+r+'"]',e).attr("price");price=0,a&&(price=parseFloat(a)),o.price_detail[i]=price,o.updatePrice(),o.updateTitle(),o.updateInfoProduct()}function t(){o.info_fit_popup=!0,s.addClass("active"),o.vertical_mode||$("#fit").addClass("fixed_mode"),i(),$("#config .scroll").perfectScrollbar("destroy")}function i(e){if(void 0!==e)t=e;else var t=o.current.config.fit;if(0==$(".video_tag."+t).length){var i="desktop";mobile_enabled&&(i="mobile");var r=$('<video playsinline class="video_tag '+t+'" muted autoplay preload auto loop data-layout="responsive" data-height="600" data-width="1000"><source src="https://d1fufvy4xao6k9.cloudfront.net/video/man/jeans/jeans_fit_'+t+"_1_"+i+'.mp4" type="video/mp4" /><source src="https://d1fufvy4xao6k9.cloudfront.net/video/man/jeans/jeans_fit_'+t+"_1_"+i+'.webm" type="video/webm" /></video>');$(".info_fit_popup .videos_fit #"+t+".video").prepend(r)}$(".ball",s).removeClass("active"),$('.ball[rel="'+t+'"]',s).addClass("active"),$(".videos_fit").attr("class","videos_fit "+t),$(".fits_action").attr("class","fits_action "+t),$(".title,.description,.apply_fit",c).hide(),$(".title."+t+",.description."+t+",.apply_fit."+t,c).show()}function r(){l.addClass("active"),this.vertical_mode||$("#config .scroll").perfectScrollbar("destroy")}function a(e=!1){if(d.addClass("active"),$("#available_window").addClass("fabric_preview_mode"),$(".receive_it").addClass("fabric_preview_mode"),$(".personalize").addClass("fabric_preview_mode"),$(".head").addClass("fabric_preview_mode"),$(window).resize(),e){$("#fabrics_info_detail").scrollTop(0);const t=$("#fabrics_info_detail #"+e).offset().top;$("#fabrics_info_detail").animate({scrollTop:t-100},"linear")}let t=$(".fabric_box.checked div.image span",u).attr("rel");return $('.fabric_box div.image span[rel="'+t+'"]',d).parents(".fabric_box").addClass("checked"),setTimeout(function(){o.bLazy_fabric.revalidate()},100),!1}var o=this,n=o.container.find(".box_opt.config");n.on("click",".option_trigger",function(){if($(this).hasClass("not_show")){var t=$(this).attr("data-title"),a=$(this).attr("description");return $(".title",l).html(t),$(".description",l).html(a),r(),!1}var n=$(this).parents(".box_opt").find("input"),s=n.attr("name"),c=(n.val(),this.getAttribute("rel")),d=$(this).parents(".box_opt"),p=$(this).attr("views");if(p&&(p=p.split(","),o.inArray(o.current.view,p)||o.changeView(p[0],!1)),$('.option_trigger[rel="'+c+'"]',d).hasClass("active"))return!0;e(d,n,s,c),o.info_fit_popup&&"fit"==s&&(i(),$(".info_fit_popup .videos_fit").attr("class","videos_fit "+c)),"fit"==s&&o.renderInitials();var u=$(this).attr("zoom");u&&o.setFocusRender(u,!1),$(".option_trigger").removeAttr("title"),$(".option_trigger.no_active").hover(function(){let e=$(this).attr("data-title");$(this).attr("title",e)})}),$("input",n).change(function(e){var t=$(this).attr("name"),i=$(this).val();o.current.config[t]=i,o.renderDraw()});var s=$(".info_fit_popup"),c=$(".info_fit_details");$(".info_fit").click(function(){t()}),$(".close",s).click(function(){o.desactiveInfoFitPopup()}),$(".apply_fit",s).click(function(){var e=$(this).attr("rel");$('#fit .option_trigger[rel="'+e+'"]').click(),o.desactiveInfoFitPopup()}),$(".apply_fit",c).click(function(){o.desactiveInfoFitPopup()}),$(".info_fit_popup").click(function(){$(this).find(".video_tag").get(0).paused?$(this).find(".video_tag").get(0).play():$(this).find(".video_tag").get(0).pause()});var l=$(".info_config_details");$(".info_config").click(function(){var e=$(this).attr("data-title"),t=$(this).attr("description");$(".title",l).html(e),$(".description",l).html(t),r()}),$(".close,.ok",l).click(function(){o.desactiveInfoConfigtPopup()}),$(".ball",s).click(function(){i($(this).attr("rel"))}),$(".fit_arrow",s).click(function(){if($(this).hasClass("left"))0==(e=$(".ball.active",s).prev()).length&&(e=$(".ball",s).last());else{var e=$(".ball.active",s).next();0==e.length&&(e=$(".ball",s).first())}e.click();var t=e.attr("rel");$('.option_trigger.fit[rel="'+t+'"]').click()}),$(".ok",s).click(function(){$(".know_more_detail").removeClass("active"),$(".info_fit_popup").removeClass("detail_active")}),$(".know_more",s).click(function(){var e=$(this).attr("rel");$(".know_more_detail."+e).addClass("active"),$(".info_fit_popup").addClass("detail_active")});var d=$(".fabrics_info_detail");$(".close",d).click(function(){d.removeClass("active"),$("#available_window").removeClass("fabric_preview_mode"),$(".receive_it").removeClass("fabric_preview_mode"),$(".personalize").removeClass("fabric_preview_mode"),$(".head").removeClass("fabric_preview_mode"),$(window).resize()}),$(".preview_fabric ").on("click",".all_fabrics",function(){a(),o.closeThumbFabric()}),$(".fabric_list").on("click","span.know_more",function(){a($(this).closest(".group_fabric").attr("id"))}),$(".fabric_global_list").on("click",".title span.i",function(){a()}),$(".info_fabrics").click(function(){a()});var p=$("#fabric"),u=p.find(".fabric_list");d.scroll(function(){o.bLazy_fabric.revalidate()}),d.on("click",".fabric_box",function(){let e=$("div.image span",this).attr("rel");$(".fabric_box.checked",u).removeClass("checked"),$(".fabric_box.checked",d).removeClass("checked"),$('.fabric_box div.image span[rel="'+e+'"]',d).parents(".fabric_box").addClass("checked");let t=$('.fabric_box div.image span[rel="'+e+'"]',u).parents(".fabric_box");t.addClass("checked"),o.current_temp.fabric=t,o.fabricSelect(p,t)})},Garment.prototype.desactiveInfoConfigtPopup=function(){$(".info_config_details").removeClass("active"),this.vertical_mode||$("#config .scroll").perfectScrollbar({suppressScrollX:!0})},Garment.prototype.desactiveInfoFitPopup=function(){var e=$(".info_fit_popup");this.info_fit_popup=!1,e.removeClass("active"),$("#fit").removeClass("fixed_mode"),this.vertical_mode||$("#config .scroll").perfectScrollbar({suppressScrollX:!0})},Garment.prototype.updateInfoProduct=function(){var e=$('.box_opt[id="fit"]').find(".option_trigger.active .text").html();$(".info_product .style").html(e);var t=$(".fabric_box.checked").parents(".group_fabric ").find(".group_fabric_title").html();$(".info_product .stretch").html(t)},Garment.prototype.initFabric=function(){var e=this,t=$("#fabric"),i=t.find(".fabric_list");t.find(".fabric_global_list");"undefined"!=typeof Blazy?e.bLazy_fabric=new Blazy({container:".fabric_container_lazy",success:function(e){e.parentNode.className=e.parentNode.className.replace(/\loading\b/,"")},error:function(e,t){dataLayer.push({event:"blazy_error"})}}):e.bLazy_fabric=!1,e.bLazy_fabric&&e.bLazy_fabric.revalidate(),i.on("click",".fabric_box",function(){if(!$(this).hasClass("checked")||!e.vertical_mode)return $(".fabric_box.checked",i).removeClass("checked"),$(this).addClass("checked"),e.current_temp.fabric=$(this),e.fabricSelect(t,$(this)),!1;var r=$(this).parents(".sidebar-options").attr("id"),a=$(this).find("span.fabric");e.showPreviewFabric(a,r)}),$(".fabric_box").each(function(){$(".subtone.trad",this).html(fabric_options_i18n[$(".subtone.trad",this).html()]),$(".composition.trad",this).html(fabric_options_i18n[$(".composition.trad",this).html()])}),$(".fabric_global_list .scroll").scroll(function(){e.bLazy_fabric.revalidate()}),$(".blocks").scroll(function(){e.bLazy_fabric.revalidate()}),$(".fabric_global_list .group_fabric").each(function(){let e=$(this).find(".fabric_box").first().find(".price").html();void 0!==e&&$('<span class="price"> '+e+"</span>").appendTo($(this).find(".group_fabric_description span.title_f"))})},Garment.prototype.fabricSelect=function(e,t,i){function r(e){var t=$("#finishing").find("input"),i=t.attr("name"),r=$("#finishing");r.find(".option_trigger.active").removeClass("active"),r.find('[rel="'+e+'"]').addClass("active"),t.val(e).change();var a=$('.option_trigger[rel="'+e+'"]',r).attr("price");f=0,a&&(f=parseFloat(a)),o.price_detail[i]=f}function a(e){var t=$("#fit").find("input"),i=(t.attr("name"),$("#fit"));i.find(".option_trigger.active").removeClass("active"),i.find('[rel="'+e+'"]').addClass("active"),t.val(e).change()}$(".favourite").removeClass("hide"),void 0===i&&(i=!0);var o=this;o.lastSharedUrl=null,o.inactive_time=0,$("#fabric .fabric_list .fabric_box").removeClass("checked"),t.addClass("checked");var n=$("span",t).attr("rel"),s=($("span",t).attr("category"),$("span",t).attr("simple_composition"),fabric_options_i18n[$("span",t).attr("sci")],$("span",t).attr("category_group"),fabric_options_i18n[$("span",t).attr("cgi")],$("span",t).attr("tone")),c=$("span",t).attr("bf_dsc");c||(c=0),o.bf_dsc=c;var l=$("span",t).attr("patch_c");o.current.fabric.patch_color=l;var d=$("span",t).attr("rivets");o.current.fabric.buttons_rivets=d;var p=$("span",t).attr("stitching");o.current.fabric.stitching_color=p;var u=$("span",t).attr("contrast_stitching");o.current.fabric.stitching_contrast_color=u,$('input[name="fabric['+o.product_type+']"]').val(n),o.current.fabric.man_jeans=n;var f=$("span",t).attr("price");o.price_detail.fabric_man_jeans=f;var _=$("span",t).attr("stitching"),v=$("span",t).attr("rivets"),h=$("span",t).attr("label");if($(".box_opt.extra.stitching .extra_trigger.default").removeClass("default"),$('.box_opt.extra.stitching .extra_trigger[rel="'+_+'"]').addClass("default"),$(".box_opt.extra.buttons_rivets .extra_trigger.default").removeClass("default"),$('.box_opt.extra.buttons_rivets .extra_trigger[rel="'+v+'"]').addClass("default"),$(".box_opt.extra.leather_label .extra_trigger.default").removeClass("default"),$('.box_opt.extra.leather_label .extra_trigger[rel="'+h+'"]').addClass("default"),o.updateExtraColorsbyFabric(),"white"==s||"beige"==s?(o.finishing_previous=$("#finishing").find("input").val(),r("clean"),$('#finishing .option_trigger[rel="basic"]').addClass("not_show"),$('#finishing .option_trigger[rel="vintage"]').addClass("not_show")):($('#finishing .option_trigger[rel="basic"]').removeClass("not_show"),$('#finishing .option_trigger[rel="vintage"]').removeClass("not_show"),o.finishing_previous&&r(o.finishing_previous)),[].indexOf(n)>-1)o.fit_previous=$("#fit").find("input").val(),"skinny"!=$("#fit").find("input").val()&&a("skinny"),$('#fit .option_trigger:not([rel="skinny"])').addClass("not_show");else{$('#fit .option_trigger:not([rel="skinny"])').removeClass("not_show");let e=["3066","3083","3101","3084","3085"],t=["3067","3079","3080","3081","3082"];e.indexOf(n)>-1||t.indexOf(n)>-1?(o.fit_previous=$("#fit").find("input").val(),e.indexOf(n)>-1?("skinny"==$("#fit").find("input").val()&&a("slim"),$('#fit .option_trigger[rel="skinny"]').addClass("not_show")):t.indexOf(n)>-1&&("straight"==$("#fit").find("input").val()&&a("slim"),$('#fit .option_trigger[rel="straight"]').addClass("not_show"))):($('#fit .option_trigger[rel="skinny"]').removeClass("not_show"),$('#fit .option_trigger[rel="straight"]').removeClass("not_show"),o.fit_previous&&a(o.fit_previous))}o.updatePrice(),o.updateInfoProduct(),i&&o.renderDraw()},Garment.prototype.keychain_isset=function(e,t){if(void 0===e)return!1;for(var i=e,r=0;r<t.length;r++){if(void 0===i[t[r]])return!1;i=i[t[r]]}return!0},Garment.prototype.initExtras=function(){var e=this,t=e.container.find("#extras");$("div.box_opt.extra",t).each(function(){var t=this.getAttribute("data-extra-type"),i=this.getAttribute("id");e.current.extras[i]=[],"function"==typeof e["initExtra_"+t]&&e["initExtra_"+t].apply(e,[i,$(this)])})},Garment.prototype.recalculeTitleExtraPadding=function(){var e=this;if(e.vertical_mode){var t=$(".box_opt.extra .title:visible");t.each(function(){0==$(this).find("span").length&&$(this).wrapInner("<span>")});var i=t.find("span");function r(){e.parts_widths=[],e.available_widths=[],e.titles_widths=[],t.each(function(){e.parts_widths.push(this.clientWidth+40),e.available_widths.push(this.offsetWidth)}),i.each(function(){e.titles_widths.push(this.clientWidth+10)})}r()}},Garment.prototype.initExtra_colors=function(e,t){var i=this;i.extraColorModified[e]=!1,$(".extra_triggers",t).on("click",".extra_trigger",function(){var r=$(this).attr("rel");i.setExtraColorOption(e,t,r),i.renderDraw();var a=$(this).attr("views");a&&(a=a.split(","),i.inArray(i.current.view,a)||i.changeView(a[0]));var o=$(this).parents(".box_opt").attr("zoom");return void 0!==i.pinchZoom.canvas_render&&o&&i.setFocusRender(o),!1})},Garment.prototype.setExtraColorOption=function(e,t,i){var r=this;$(".extra_trigger.active",t).removeClass("active");var a=$('.extra_triggers .extra_trigger[rel="'+i+'"]',t).addClass("active");a.addClass("active");var o=t.attr("data-price");a.hasClass("default")?($('input[name_current="contrast"]',t).val("default"),$('input[name_current="type"]',t).val(""),o=0):($('input[name_current="contrast"]',t).val("personalizado"),$('input[name_current="type"]',t).val(i),r.extraColorModified[e]=!0),r.extraSetPrice(e,o),void 0!==r.product_config[e].contrast&&r.relationsApply(e+"[contrast]",r.product_config[e].contrast[rel])},Garment.prototype.updateExtraColorsbyFabric=function(){var e=this;$('.box_opt.extra[data-extra-type="colors"]').each(function(){var t=$(this).attr("data-price"),i=$(this).attr("id"),r=$("#"+i);if(e.extraColorModified[i]){if($(".extra_trigger.active",this).hasClass("default"))$('input[name_current="contrast"]',this).val("default"),$('input[name_current="type"]',this).val(""),t=0;else{$('input[name_current="contrast"]',this).val("personalizado");a=$(".extra_trigger.active",this).attr("rel");$('input[name_current="type"]',this).val(a)}e.extraSetPrice(i,t)}else{var a=$(".extra_trigger.default",this).attr("rel");e.setExtraColorOption(i,r,a)}})},Garment.prototype.initExtra_initials=function(e,t){function i(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}function r(t){if(o){var i=$('input[name="'+e+'[text]"]',t).val();a.current.extras[e].text=i;var r=$('input[name="'+e+'[color]"]',t).val();a.current.extras[e].color=r;var n=$('input[name="'+e+'[font]"]',t).val();a.current.extras[e].font=n;var s=$('input[name="'+e+'[pos]"]',t).val();a.current.extras[e].pos=s,a.setFocusRender("initials_"+a.current.view),a.renderInitials()}else a.current.extras[e]=[],a.removeRenderInitials()}var a=this,o=!1,n=t.find(".position_box ");if(n.on("click",".extra_trigger ",function(){n.find(".extra_trigger.active").removeClass("active"),$(this).addClass("active");var i=$(this).attr("rel");$("input",n).val(i);var s=parseFloat(t.attr("data-price")),c=!1;"without"==i?(o=!1,a.extraSetPrice(e,0),t.removeClass("active"),$(".extras .option_balls .initials_extra").addClass("hide")):(""!=$('input[name="'+e+'[text]"]').val()?(o=!0,a.extraSetPrice(e,s)):$(".input_box").addClass("empty"),t.addClass("active"),$(".extras .option_balls .initials_extra").removeClass("hide"),$('input[name="'+e+'[text]"]').val()||(c=!0)),$("#extras .scroll").perfectScrollbar("update"),r(t),a.calculateBallsAutoScroll(),a.vertical_mode&&c&&$('.ball.initials_extra[rel="input_box"]').click();var l=$(this).attr("views");return l&&(l=l.split(","),a.inArray(a.current.view,l)||a.changeView(l[0])),a.recalculeTitleExtraPadding(),!1}),void 0!==window.visualViewport){var s=window.visualViewport;function c(){i()&&($('input[name="'+e+'[text]"]',t).is(":focus")?($("#available_window").css("bottom","0px"),$("#available_window").css("top","auto"),$("#available_window").css("height",+s.height+"px")):($("#available_window").css("bottom",""),$("#available_window").css("top",""),$("#available_window").css("height","")),a.handleResize())}window.visualViewport.addEventListener("resize",c)}$('input[name="'+e+'[text]"]',t).keyup(function(i){i.keyCode||i.which;if(""!=$(this).val()){o=!0;var n=parseFloat(t.attr("data-price"));isNaN(n)&&(n=0),a.extraSetPrice(e,n),$(".input_box").removeClass("empty")}else a.extraSetPrice(e,0),$(".input_box").addClass("empty"),o=!1;r(t)}),$(document).ready(function(){$(window).keydown(function(e){if(13==e.keyCode)return e.preventDefault(),!1})});var l=t.find(".input_fonts");l.on("click",".extra_trigger",function(){l.find(".extra_trigger.active").removeClass("active"),$(this).addClass("active");var i=$(this).attr("rel");return $("input",l).val(i),r(t),$(".txt_initial",t).removeClass("bold_script").removeClass("script").removeClass("times_roman"),$(".txt_initial",t).addClass(i),""==$('input[name="'+e+'[text]"]').val()&&$(".input_box").addClass("empty"),!1});var d=$(".input_colors",t);d.on("click",".extra_trigger",function(){$(this).parent().find(".extra_trigger.active").removeClass("active");var i=$(this).attr("rel"),i=$(this).attr("rel");return $("input",d).val(i),$(this).addClass("active"),r(t),""==$('input[name="'+e+'[text]"]').val()&&$(".input_box").addClass("empty"),!1})},Garment.prototype.renderInitials=function(){var e=this,t=e.current.extras.initials,i=t.text,r=t.color,a=t.pos,o=t.font;if(e.removeRenderInitials(),i&&r&&o&&("front"==e.current.view&&"front"==a||"back"==e.current.view&&"back"==a)){var n={bold_script:"Bold Script",script:"Script",times_roman:"Times New Roman"};if(void 0===n[o])return!1;o=n[o],"gold"==r?r="a48239":"grey"==r?r="b3b3b3":"black"==r?r="000000":"fucsia"==r?r="b80e58":"fucsia"==r?r="b80e58":"red"==r?r="c20000":"light_blue"==r?r="b8f2f2":"blue"==r&&(r="4477cf");l=200;"slim"==e.current.config.fit?l=225:"skinny"==e.current.config.fit?l=235:"bootcut"==e.current.config.fit&&(l=225);var s=245;"slim"==e.current.config.fit?s=265:"skinny"==e.current.config.fit?s=280:"bootcut"==e.current.config.fit&&(s=265);var c={front:{top:l,left:615,rotate:-6},back:{top:s,left:185,rotate:-5}},l=c[this.current.view].top,d=c[this.current.view].left,p=c[this.current.view].rotate;if(void 0!==e.pinchZoom.canvas_render){var u={text:i,color:"#"+r,top:l,left:d,font_family:o,font_size:22,rotate:p};e.pinchZoom.canvas_render.setInitials(u),e.handleResize()}}},Garment.prototype.removeRenderInitials=function(){var e=this;void 0!==e.pinchZoom.canvas_render&&e.pinchZoom.canvas_render.removeInitials()},Garment.prototype.setFocusRender=function(e,t=!0){var i=this;if(e==i.focusActual)return!0;if(void 0!==i.pinchZoom.canvas_render){if("general"==e)$(".share_and_fav").removeClass("zoom_applied"),i.pinchZoom.canvas_render.removefocusOn();else{$(".share_and_fav").addClass("zoom_applied");var r="base";if(i.vertical_mode&&(r="vertical"),!i.focusArray[r][e])return!1;let a=i.focusArray[r][e].x,o=i.focusArray[r][e].y,n=i.focusArray[r][e].width;i.pinchZoom.canvas_render.setfocusOn(a,o,n,t)}i.focusActual=e}},Garment.prototype.initShareAndFav=function(){function e(e){var e=parseInt(e);$('.add_to_cart[data-id="'+e+'"]',p).addClass("hide"),$('.go_to_cart_loader[data-id="'+e+'"]',p).addClass("visible");i=window.location.origin+"/"+region+"/services/personalize/"+l.product_type+"?ajax=1";if(e)$.post(i,{id_product:e,save_cart_by_feed:!0},function(t){t&&($('.go_to_cart_loader[data-id="'+e+'"]',p).removeClass("visible"),$('.go_to_cart[data-id="'+e+'"]',p).addClass("visible"))});else{s(),$(l.container).append('<input type="hidden" name="next_save_cart" value="1" class="input_auto_delete"/>');var t=$("form").serialize(),i=window.location.origin+"/"+region+"/services/personalize/"+l.product_type+"?ajax=1";$.ajax({type:"POST",url:i,data:t,success:function(e){dataLayer.push({event:"analyticsEvent",eventCategory:"personalize",eventAction:"add_to_cart",eventLabel:"mobile"})}})}}function t(e){var e=parseInt(e);if(v)i=v.email;else if(customer)i=window.getStoredCustomer().email;else{var t=window.getStoredCustomerTemp();if(t)var i=t.email}if(e&&i){var r=window.location.origin+"/"+region+"/services/personalize/"+l.product_type+"?ajax=1";$.post(r,{id_product:e,email:i,remove_product_wish_list:!0},function(e){if(e){var t=l.cont_favorites+1,i="product_"+t;t>2&&(i="product_3_more"),p.removeClass(i),i="product_"+l.cont_favorites,l.cont_favorites>2&&(i="product_3_more"),p.addClass(i),$("#favourite_product_popup .products").perfectScrollbar("update")}})}}function i(){f.addClass("visible"),p.addClass("visible"),$(".products",p).show()}function r(e){if(e=parseInt(e)){var t=window.location.origin+"/"+region+"/services/personalize/"+l.product_type+"?ajax=1";$.post(t,{id_product:e,share_favorite_product:!0},function(e){if(e){if(u.addClass("show"),f.addClass("visible"),p.removeClass("visible"),$(".loading","#share_popup").addClass("hide"),"ko"==e){var t=$(tmpl("share_product_error_tmpl",[]));return void $(".flex","#share_popup").html(t)}c((e=JSON.parse(e)).url_product,e.img_src,e.product_title)}})}}function a(e){var t=$("#favourite_product_popup");if(l.customer_active){var i=window.getStoredCustomer();if(i)a=i.email;else{var r=window.getStoredCustomerTemp();if(r)var a=r.email}}if(!a){if(null==(a=$('.content input[name="email"]',t).val()).match(/[\S]+[\@][\S]+[\.][\S]+/i))return $(".email_error_format").show(),!1;$(".email_error_format").hide()}p.removeClass("visible"),f.removeClass("visible"),$(".favourite").addClass("hide"),s(),$(l.container).append('<input type="hidden" name="add_favourite_product" value="1"  class="input_auto_delete"/>'),$("form").append('<input type="hidden" name="email" value="'+a+'"   class="input_auto_delete"/>');var o=$("form").serialize();setTimeout(function(){$("#add_product_popup_message").addClass("visible")},1e3),setTimeout(function(){$("#add_product_popup_message").removeClass("visible")},4e3),void 0===l.cont_favorites&&(l.cont_favorites=0),l.cont_favorites++;var n="product_"+l.cont_favorites;l.cont_favorites>2&&(n="product_3_more"),p.addClass(n),l.customer_active||(l.cont_favorites=1,$("#favorites span").html(l.cont_favorites),$(".fav_box_header").addClass("visible"));var c=window.location.origin+"/"+region+"/services/personalize/"+l.product_type+"?ajax=1";return $.ajax({type:"POST",url:c,data:o,success:function(t){if(t){var o=(t=JSON.parse(t)).id_product;if($(p).addClass("customer_active"),$(".your_wish_list",p).hide(),$(".your_wish_list.has-customer",p).show(),l.customer_active=!0,l.product_saved=!0,p.addClass("customer_active"),$(".your_wish_list",p).hide(),$(".your_wish_list.has-customer",p).show(),!i&&!r){var n={email:a};n=JSON.stringify(n),window.localStorage.setItem("customer_temp",n)}if($("#favorites span").html(l.cont_favorites),$("#favorites").addClass("visible"),o){$(".product",p).first().addClass("saved"),$(".product",p).first().find(".add_to_cart").attr("data-id",o),$(".product",p).first().find(".remove").attr("data-id",o),$(".product",p).first().find(".share").attr("data-id",o),$(".product",p).first().find(".go_to_cart").attr("data-id",o),$(".product",p).first().find(".go_to_cart_loader").attr("data-id",o);var s=$(".product",p).first().find(".wrap_image").attr("href");s=s.replace("#id_product#",o),$(".product",p).first().find(".wrap_image").attr("href",s);var c=t.title;c&&$(".product",p).first().find(".title").html(c)}e&&"function"==typeof e&&e()}}}),dataLayer.push({event:"analyticsEvent",eventCategory:"personalize",eventAction:"add_favorite",eventLabel:"mobile"}),!0}function o(){$("canvas.image.new",p).removeClass("new").attr("id","popup_favourite_product_canvas_old"),f.addClass("visible"),p.addClass("visible"),p.find(".loading").addClass("active"),l.customer_active||$(".product",p).remove();var e=$(".info_product .price").html().match(/\d+/g)[0],t={title:$(".name_price h1").html(),price:formatPrice(e)},i=$(tmpl("favourite_product_tmpl",t));$(".products",p).prepend(i),1!==$(".products .product",p).length||l.customer_active?$(".products",p).show():$(".products",p).hide();var r=l.current.view;l.current.view="front";$("canvas",p).css("width",80),$("canvas",p).css("height",150),l.renderDraw(!1,!1,!1,"favourite_product"),l.current.view=r;$(".image",p).css("width",80),$(".image",p).css("max-width","130px")}function n(){if(h=!0,v.email){var e=window.location.origin+"/"+region+"/services/personalize/"+l.product_type+"?ajax=1";$.post(e,{email:v.email,get_wish_list:!0,product_type:l.product_type,logged:_},function(e){if(e){e=JSON.parse(e);var t=$("#favourite_product_popup"),i=e.length;if(i>0){l.cont_favorites=i,$("#favorites span").html(i),$(".fav_box_header").addClass("visible");var r="product_"+l.cont_favorites;l.cont_favorites>2&&(r="product_3_more"),t.addClass(r);for(var a in e){var o={title:e[a].product_title,price:formatPrice(e[a].price)},n=$(tmpl("favourite_product_tmpl",o));$(".products",t).prepend(n);var s=e[a].img_src,c=$('<img src="'+s+'">');$("#favourite_product_popup .image canvas").first().remove(),$("#favourite_product_popup .image").first().html(c);"botin"!=l.current.config.type&&"chukka"!=l.current.config.type&&"chelsea"!=l.current.config.type||"front";var d=150;l.complex&&(d+=10),$(".image",t).css("width",d);var p=e[a].id_product;$(".product",t).first().find(".add_to_cart").attr("data-id",p),$(".product",t).first().find(".remove").attr("data-id",p),$(".product",t).first().find(".share").attr("data-id",p),$(".product",t).first().find(".go_to_cart").attr("data-id",p),$(".product",t).first().find(".go_to_cart_loader").attr("data-id",p);var u=$(".product",t).first().find(".wrap_image").attr("href");u=u.replace("#id_product#",p),$(".product",t).first().find(".wrap_image").attr("href",u)}$(".product","#favourite_product_popup").addClass("saved")}}})}}function s(){$(".input_auto_delete",l.container).remove()}function c(e,t,i){var r={link:encodeURIComponent(e),raw_link:e,img:encodeURIComponent(t),title:encodeURIComponent(i)},a=$(tmpl("share_product_tmpl",r));$(".flex","#share_popup").html(a),void 0!==navigator.share&&$(".social.native","#share_popup").removeClass("hide")}var l=this,d=$("body"),p=($("#save_product_popup"),$("#favourite_product_popup")),u=$("#share_popup"),f=$("#disable_popup");if($("#favourite_product_popup .products").perfectScrollbar(),d.on("click",".social a",u,function(e){return!(!$(this).hasClass("email")&&!$(this).hasClass("copylink"))||(e.preventDefault(),window.open($(this).attr("href"),"ShareWindow","height=450, width=550, top="+($(window).height()/2-275)+", left="+($(window).width()/2-225)+", toolbar=0, location=0, menubar=0, directories=0, scrollbars=0"),!1)}),customer||customer_temp){var _=!1,v=!1;customer?(v=window.getStoredCustomer(),_=!0):customer_temp&&(v=window.getStoredCustomerTemp())}p.on("click",".add_to_cart",function(){var t=$(this).attr("data-id");t&&e(t)}),p.on("click",".remove",function(){var e=$(this).attr("data-id"),i=$(this).attr("data-text");confirm(i)&&"null"!=e&&(t(e),$(this).parents(".product").remove(),l.cont_favorites--,$("#favorites span").html(l.cont_favorites),0==$(".product",p).length&&(p.removeClass("visible"),f.removeClass("visible")))}),p.on("click",".share",function(){var e=$(this).attr("data-id");"null"!=e&&r(e)}),(customer||customer_temp)&&($(p).addClass("customer_active"),$(".your_wish_list",p).hide(),$(".your_wish_list.has-customer",p).show(),l.customer_active=!0),$("#share_popup").on("click",".social.native a.native",function(e){e.preventDefault();var t=$(this);return void 0!==navigator.share&&navigator.share({title:t.data("title"),text:t.data("text"),url:decodeURIComponent(t.data("link"))}).then(function(){dataLayer.push({event:"share_product",eventCategory:"share_product",eventAction:"native",eventLabel:"mobile"})}).catch(function(e){}),!1});var h=!1;d.on("click",".favourite",function(){if($(this).hasClass("hide"))return f.addClass("visible"),p.addClass("visible"),!1;l.customer_active&&(h||n(),a()),o()}),f.click(function(){p.removeClass("visible"),f.removeClass("visible"),u.removeClass("show")}),d.on("click","#favourite_product_popup .close",function(){p.removeClass("visible"),f.removeClass("visible")}),d.on("click","#favourite_product_popup .save",function(){a(function(){$("#favorites").trigger("click")})}),$("#favourite_product_popup input").keydown(function(e){13===e.which&&$(".save","#favourite_product_popup").click()}),$("body").on("click","#favorites",function(e){e.preventDefault(),e.stopPropagation(),i()}),d.on("click",".copylink",function(e){e.preventDefault(),$(".social-link input").get(0).select(),document.execCommand("copy"),$(".copylinkok").fadeIn(),setTimeout(function(){$(".copylinkok").hide()},3e3)}),l.customer_active&&n()},String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+this.slice(1)},Garment.prototype.showPreviewFabric=function(e,t){var i=$(".preview_fabric");this.push_dataLayer("config_"+this.product_type,"step:zoom_fabric");var r=this,a={id_fabric:e.attr("rel"),title:e.attr("name"),new:e.attr("new"),composition:e.attr("c"),subtone:e.attr("st"),season:e.attr("ss"),weight:e.attr("w"),simple_composition:e.attr("sci"),tone:e.attr("tp"),price:e.attr("price"),fabric_detail_info:$(".fabric_jean_detail_html",e).html()};fabric_family_div=e.parents(".fabric_family"),group_fabric_div=e.parents(".group_fabric");var o={family_name:group_fabric_div.find(".group_fabric_title ").html(),reference:fabric_family_div.attr("reference"),composition:fabric_family_div.attr("composition"),description:fabric_family_div.attr("description")};$(".family span:not(.h)",i).html(o.family_name),$(".reference span:not(.h)",i).html(o.reference),$(".composition",i).html(o.composition),$(".desc",i).html(o.description),$(".family_fabrics",i).html(fabric_family_div.html()),1==$(".family_fabrics .fabric_box",i).length?i.addClass("single_mode"):i.removeClass("single_mode"),r.fabric_preview_open=a.id_fabric;var n=window.cdn_host;if(void 0!==a.id_fabric){var s=n+"dimg/fabric/jeans/"+a.id_fabric+"_huge.jpg";$(".image.main img",i).attr("src",s),$(".image.main img",i).attr("onerror","this.src='"+s+"';")}var c=fabric_options_i18n[a.simple_composition];c&&$(".simple_composition",i).html(c);var l=a.composition;"linen"==l&&(l="100linen");for(var d,p=/(\d+)([a-z\d]+)/g,u=[],f=!1;d=p.exec(l);)u.push(d[1]+"% "+(void 0===fabric_options_i18n[d[2]]?d[2]:fabric_options_i18n[d[2]]));u.length?f=u.join(" &amp; "):void 0!==fabric_options_i18n[l]&&(f=fabric_options_i18n[l]),f&&$(".composition",i).html(f),a.title&&$(".name",i).html(a.title).show(),$(".subtone",i).html(fabric_options_i18n[a.subtone]).show(),$(".season",i).html(fabric_options_i18n[a.season]).show();var _=a.weight;"undefined"==typeof region||"en-uk"!=region&&"en-us"!=region?_+=" gr/m2":(_=Math.round(.02949*a.weight*100)/100,_+=" oz/yd<sup>2</sup>"),$(".weight",i).html(_).show(),a.fabric_detail_info?($(".info_detail_fabric",i).removeClass("force_hide"),$(".info_detail_fabric .text",i).html(a.fabric_detail_info),$(".more_info",i).click(function(){$(".info_detail_fabric",i).addClass("visible")}),$(".less_info",i).click(function(){$(".info_detail_fabric",i).removeClass("visible")})):$(".info_detail_fabric",i).addClass("force_hide"),r.current.fabric.man_jeans!=a.id_fabric&&$('.fabric_box div[rel="'+a.id_fabric+'"]').parent().click(),$(".preview_fabric").addClass("active"),$("#available_window").addClass("fabric_preview_mode"),$(".receive_it").addClass("fabric_preview_mode"),$(".personalize").addClass("fabric_preview_mode"),$(".head").addClass("fabric_preview_mode"),$(window).resize()},Garment.prototype.closeThumbFabric=function(){this.fabric_preview_open=!1,$(".preview_fabric").removeClass("active"),$("#available_window").removeClass("fabric_preview_mode"),$(".receive_it").removeClass("fabric_preview_mode"),$(".personalize").removeClass("fabric_preview_mode"),$(".head").removeClass("fabric_preview_mode"),$(window).resize()},Garment.prototype.initThumbFabric=function(){function e(e){var i=window.cdn_host,r=$('.fabric_list .fabric_box div[rel="'+e+'"]'),a=$('.family_fabrics .fabric_box div[rel="'+e+'"]').parent();$(".family_fabrics .fabric_box.checked").removeClass("checked"),a.addClass("checked");var o=i+"dimg/fabric/jeans/"+e+"_huge.jpg",n=$(".preview_fabric");$(".image.main img",n).attr("src",o),t.fabricSelect(t.container,r.parent())}var t=this,i=$(".preview_fabric",t.container);$(".seersucker_warning",t.container);$(".fabric_list .fabric_box").on("click","span.thumb_preview",function(){var e=$(this).parents(".sidebar-options").attr("id"),i=$(this).parents("span.fabric");return t.showPreviewFabric(i,e),!1}),i.on("click",".close",function(){t.closeThumbFabric()}),i.on("click",".apply_fabric",function(){var e=$('.fabric_box div[rel="'+t.fabric_preview_open+'"]');t.fabricSelect(t.container,e.parent()),t.closeThumbFabric()}),i.on("click",".fabric_box",function(){e($(this).find("div.image").attr("rel"))}),i.on("click",".arrow ",function(){var i=[];if($(".family_fabrics .fabric_box div.image").each(function(){i.push($(this).attr("rel"))}),t.fabric_preview_open=$(".family_fabrics .fabric_box.checked").find("div.image").attr("rel"),$(".family_fabrics .fabric_box.checked").removeClass("checked"),$(this).hasClass("left"))(r=(r=i.indexOf(t.fabric_preview_open))-1)<0&&(r=i.length-1),(a=$('.fabric_box div[rel="'+i[r]+'"]').parent()).click();else{var r=i.indexOf(t.fabric_preview_open);(r=r+1)>=i.length&&(r=0);var a=$('.fabric_box div[rel="'+i[r]+'"]').parent();a.click()}e(i[r])})},Garment.prototype.isFF=function(){return navigator.userAgent.toLowerCase().indexOf("firefox")>-1},Garment.prototype.push_dataLayer=function(e,t){dataLayer&&dataLayer.push({event:"configurator",eventCategory:e,eventAction:t,eventLabel:"desktop"})},Garment.prototype.validateStateButtonHoles=function(e){var t=!1,i=0;return $(".color_section.active, .thread_section.active",e).each(function(){""!=$("input",this).val()&&++i}),i>=1&&(t=!0),t},Garment.prototype.removeAllFilters=function(e,t,i,r,a){var o=this,n=[];e.find(".active_filters li").each(function(){$(this).remove()}),o.update_fabric_list(t,n,n,e),e.find(".extra_fabrics").scrollTop(0),a.find(".item_menu_filter.active .sub_menu_filter").removeClass("active").hide(),a.find(".item_menu_filter.active").removeClass("active"),a.find(".item_menu.active").removeClass("active"),a.find(".filter li.active").removeClass("active"),a.find(".filter li.all").addClass("active")},Garment.prototype.extraSetPrice=function(e,t){var i=this;i.inactive_time=0;if(t>0){r=$("#"+e,i.container);$("input",r).each(function(){var t=$(this).attr("name_current"),r=$(this).val();i.current.extras[e][t]=r})}else{var r=$("#"+e,i.container);i.current.extras[e]=[],"contrasts"==e&&$("input",r).each(function(){var t=$(this).attr("name_current");i.current.extras[e][t]=""})}this.price_detail[e]=t,this.updatePrice(),t>0?$('#extra .container_options ul span[href="'+e+'"]').addClass("inc_price"):$('#extra .container_options ul span[href="'+e+'"]').removeClass("inc_price")},Garment.prototype.inArray=function(e,t){if(!t)return!1;for(var i=t.length,r=0;r<i;r++)if(t[r]==e)return!0;return!1},Garment.prototype.updatePrice=function(){var e=this,t=0;for(var i in e.price_detail)isNaN(e.price_detail[i])&&delete e.price_detail[i],t+=parseFloat(e.price_detail[i]);if(e.bf_dsc>0&&window.blackfriday_enabled){var r=t;t*=1-e.bf_dsc/100}var a=format_price(t=Math.round(100*t)/100,"text",window.currency_json);if(a.indexOf("CHF")>-1&&(a=a.replace("CHF","")+".-"),$(".product_i div.price").html(a),$(".price_original").remove(),e.bf_dsc>0&&window.blackfriday_enabled){$(".info_product div.price").not(".original_price").addClass("discount");var o=format_price(r,"small_symbol",window.currency_json);$(".info_product .name_price .price").before('<div class="price_original">'+o+"</div>")}else $(".product_i div.price").removeClass("discount"),$(".product_i div.original_price").hide()},Garment.prototype.updateConfiguratedProduct=function(e){var t=this,i=t.container,r=$("#fabric",t.container),a=$("#extras",t.container);"default"==e&&(product=this.current);var o=product.config;if(o){$(".option_trigger",i).removeClass("active");for(k in o){t.current.config[k]=o[k],$('input[name="'+k+'"]',i).val(o[k]),$('.box_opt[id="'+k+'"] .option_trigger[rel="'+o[k]+'"]',i).addClass("active");var n=$('.box_opt[id="'+k+'"] .option_trigger[rel="'+o[k]+'"]',i).attr("price");n||(n=$('.subbox_opt[id="'+k+'"] .option_trigger[rel="'+o[k]+'"]',i).attr("price")),n>0&&(t.price_detail[k]=n,t.updatePrice()),void 0!==t.product_config[k]&&t.relationsApply(k,t.product_config[k][o[k]])}t.updateTitle(),t.updateInfoProduct()}var s=product.fabric;if(s||(s=this.current),s){var c=s.id_t4l_fabric;if(void 0===s.id_t4l_fabric&&(c=s.man_jeans),t.current.fabric.man_jeans=c,c){var l=$('#fabric .fabric_list .fabric_box div[rel="'+c+'"]');t.fabricSelect(r,l.parent(),!1)}}var d=product.extras;if(jQuery.isEmptyObject(d)&&(d=this.current.extras),d)for(k in d)if(k.indexOf("initials")>-1){var p=$(".box_opt."+k,a);t.updateExtraInitials(k,d[k],p)}else{var u=$(".box_opt."+k,a);t.updateExtraColors(k,d[k],u)}t.renderDraw();var f=parse_query_string(document.location.search,"step");"fabric"==f?$('.header .option[rel="'+f+'"]').click():"extra"==f&&$('.header .option[rel="extras"]').click();var _=parse_query_string(document.location.search,"fit");_&&$('.option_trigger.fit[rel="'+_+'"]').click(),"back"==parse_query_string(document.location.search,"view")&&t.changeView("back");var v=parse_query_string(document.location.search,"zoom");"true"==v?$(".share_and_fav .opt_r.plus").click():"focus_top"==v?t.setFocusRender("top",!1):"focus_bottom"==v&&t.setFocusRender("bottom",!1)},Garment.prototype.updateExtraColors=function(e,t,i){var r=this;"personalizado"==t.contrast&&void 0!==t.type&&r.setExtraColorOption(e,i,t.type)},Garment.prototype.updateExtraInitials=function(e,t,i){for(var r in t)if(!t[r])return!1;$('.box_position_initial  .extra_trigger[rel="'+t.pos+'"]',i).click(),$('.input_fonts .extra_trigger[rel="'+t.font+'"]',i).click(),$('.input_colors .extra_trigger[rel="'+t.color+'"]',i).click(),$('input[name="'+e+'[text]"]',i).val(t.text).keyup()},Garment.prototype.getCurrentLayers=function(){return this.current},Garment.prototype.parseImages=function(e,t,i){var r=this.getLayers();r=this.parseLayers(r,t,i);var a=[];for(key in e){var o=e[key];array_push(a,[r[o.layer].src+o.src,o.zIndex,o.class,o.render])}return a},Garment.prototype.renderDraw=function(e,t,i,r){var a=this;e||(e="STD"),r||(r=!1),this.current.size=e,this.current.inner_strip_desactive=!1;var o=this.renderGetImages(),n=[];for(var s in o)n.push(o[s][0]);a.new_images=n;var c="canvas_render",l=!0;"BIG"==e&&(l=!1,c="canvas_render_zoom"),"favourite_product"===r&&(c="popup_favourite_product_canvas",$("#favourite_product_popup .loading").removeClass("active"),a.initCanvas(c,!1)),"save_popup_product"===r&&(c="popup_save_product_popup",$("#save_product_popup .loading").removeClass("active"),a.initCanvas(c,!1)),void 0===a.pinchZoom[c]&&a.initCanvas(c,l),a.setPreviousNextImages();$(".fabric_piece:not(.not_show):not(.man_shoe)").map(function(){return $(this).attr("rel")}).get();a.pinchZoom[c].setImages(n,this.current.view),$(".loading_personalize").hide(),a.handleResize()},Garment.prototype.handleResize=function(e){var t=this,i="canvas_render",r=!0;t.zoom_mode_active&&(i="canvas_render_zoom",r=!1);var e=document.getElementById(i);void 0===t.pinchZoom[i]&&t.initCanvas(i,r);var a=e.parentNode.getBoundingClientRect();void 0!==t.pinchZoom[i]&&(t.pinchZoom[i].padding={x:0,y:0},this.zoom_mode_active&&(t.pinchZoom[i].maxWidth=2500),t.pinchZoom[i].resize(a.width,a.height))},Garment.prototype.initCanvas=function(e,t){var i=document.getElementById(e),r=this;t&&(i.addEventListener("hoverClick",function(e){}),i.addEventListener("swipeLeft",function(){r.index_v<r.available_views.length-1?r.index_v++:r.index_v=0,r.changeView(r.available_views[r.index_v])}),i.addEventListener("swipeRight",function(){0==r.index_v?r.index_v=r.available_views.length-1:r.index_v--,r.changeView(r.available_views[r.index_v])}));var a=!1,o=!1;this.vertical_mode&&"canvas_render_zoom"==e&&(a=!0,o=!0),this.pinchZoom[e]=new PinchZoomCanvas({canvas:i,momentum:!0,zoomable:a,doubletap:!1,maxWidth:2e3,eventsEnabled:o}),this.setPreviousNextImages()},Garment.prototype.setPreviousNextImages=function(){var e=this;if(e.index_v<e.available_views.length-1)t=e.index_v+1;else var t=0;if(0==e.index_v)i=e.available_views.length-1;else var i=e.index_v-1;$("#available_window ul.views").attr("i18n"),$("#available_window ul.views").attr("i18n");var r="https://d1fufvy4xao6k9.cloudfront.net/images/man/jeans/";e.current.config.type,e.views[i],e.current.config.type,e.views[t]},Garment.prototype.parseLayers=function(e,t,i){i||(i="STD"),view=t.view;var r=t.fabric.patch_color;void 0!==t.extras.leather_label&&t.extras.leather_label.type&&(r=t.extras.leather_label.type);var a=t.fabric.buttons_rivets;void 0!==t.extras.buttons_rivets&&t.extras.buttons_rivets.type&&(a=t.extras.buttons_rivets.type);var o=t.fabric.stitching_contrast_color,n=t.fabric.stitching_color;void 0!==t.extras.stitching&&t.extras.stitching.type&&(n=t.extras.stitching.type,o=t.extras.stitching.type);var s=t.fabric.man_jeans;for(k in e){e[k];e[k].src=str_replace("#man_jeans#",s,e[k].src),e[k].src=str_replace("#view#",view,e[k].src),e[k].src=str_replace("#size#",i,e[k].src),e[k].src=str_replace("#patch_color#",r,e[k].src),e[k].src=str_replace("#buttons_color#",a,e[k].src),e[k].src=str_replace("#stitching_color#",n,e[k].src),e[k].src=str_replace("#stitching_contrast_color#",o,e[k].src),e[k].src=e[k].src.replace(/^\//,window.cdn_host)}return e},Garment.prototype.relationsApply=function(e,t){function i(t,i){var a=$(t.css_selector,r.container);if(!a.length)return!0;switch(t.rel_type){case"disable":if(i){var o=!1;for(var n in r._relations_active)if(n!=e)for(var s in r._relations_active[n])if("disable"==r._relations_active[n][s].rel_type){var c=r._relations_active[n][s];if(c.block!=t.block)continue;if(c.field_name!=t.field_name)continue;if(c.field_values&&t.field_values)for(var s in t.field_values)-1!=jQuery.inArray(t.field_values[s],c.field_values)&&t.field_values.splice(s,1);else if(c.field_values);else if(!t.field_values){o=!0;break}}if(o)break}p=i?"show":"hide";if(t.field_values){if(a.hasClass("box_opt")){var l=!1;for(var d in t.field_values){$(".blocks.active .option_balls .ball.active").attr("width");"show"==p?$('.option_trigger[rel="'+t.field_values[d]+'"]',a).removeClass("not_show").trigger("cssClassChanged"):$('.option_trigger[rel="'+t.field_values[d]+'"]',a).addClass("not_show").trigger("cssClassChanged"),"hide"==p?$('.option_trigger[rel="'+t.field_values[d]+'"]',a).addClass("no_active").trigger("cssClassChanged"):$('.option_trigger[rel="'+t.field_values[d]+'"]',a).removeClass("no_active").trigger("cssClassChanged"),$('.option_trigger[rel="'+t.field_values[d]+'"]',a).hasClass("active")&&(l=!0)}l&&$(".option_trigger:not(.no_active)",a).first().click()}}else"show"==p?a.removeClass("not_show"):a.addClass("not_show");break;case"enable":var p=i?"hide":"show"}}var r=this;if(void 0!==this._relations_active[e])for(var a in this._relations_active[e])i(this._relations_active[e][a],!0);this._relations_active[e]=[];for(var a in t){var o=this.relationParse(t[a]);i(o),this._relations_active[e].push(o)}},Garment.prototype.relationParse=function(e){var t,i,r={rel_type:!1,step:!1,block:!1,field_name:!1,field_values:!1,css_selector:!1};return t=e.split("#"),r.rel_type=t[0],t=t[1].split(":"),i="#"+t[0],r.step=t[0],t.length>1&&(r.block=t[1]),t.length>2&&(i="#"+t[2],r.field_name=t[2]),t.length>3&&(i="#"+t[2],r.field_values=t[3].replace("[","").replace("]","").split(",")),r.css_selector=i,r},Garment.prototype.updateTitle=function(){this.current.config;var e=$("html").prop("lang"),t="";"en"==(e=(e=e.toString().split("-"))[0])||"ru"==e?t="Custom Jeans":"es"==e?t="Jeans a medida":"de"==e?t="massjeans":"it"==e?t="Jeans su misura":"fr"==e&&(t="Jeans sur-mesure"),$(".product_i .name_price h1").html(t)},String.prototype.trim=function(e){var t,i=0,r=0,a=this+"";for(t=e?(e+="").replace(/([\[\]\(\)\.\?\/\*\{\}\+\$\^\:])/g,"$1"):" \n\r\t\f\v\u2028\u2029",i=a.length,r=0;r<i;r++)if(-1===t.indexOf(a.charAt(r))){a=a.substring(r);break}for(r=(i=a.length)-1;r>=0;r--)if(-1===t.indexOf(a.charAt(r))){a=a.substring(0,r+1);break}return-1===t.indexOf(a.charAt(0))?a:""},String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+this.slice(1)},String.prototype.getID=function(e){return e?this.replace(/^[^#]*#/,""):this.replace(/^[^#]*/,"")},Object.size=function(e){var t,i=0;for(t in e)e.hasOwnProperty(t)&&i++;return i};